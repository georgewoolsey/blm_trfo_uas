<!DOCTYPE html>
<html lang="en-US" xml:lang="en-US">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 3 Slash Piles | BLM Tres Rios Field Office: Dawson project area UAS data</title>
  <meta name="description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 3 Slash Piles | BLM Tres Rios Field Office: Dawson project area UAS data" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 3 Slash Piles | BLM Tres Rios Field Office: Dawson project area UAS data" />
  
  <meta name="twitter:description" content="Using the bookdown package to write a book of data exploration. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="George Woolsey" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="processing.html"/>
<link rel="next" href="treatment-unit-silvicultural-summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<script src="libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet" />
<link href="libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script type="text/javascript">

// toggle visibility of R source blocks in R Markdown output
function toggle_R() {
  var x = document.getElementsByClassName('r');
  if (x.length == 0) return;
  function toggle_vis(o) {
    var d = o.style.display;
    o.style.display = (d == 'block' || d == '') ? 'none':'block';
  }

  for (i = 0; i < x.length; i++) {
    var y = x[i];
    if (y.tagName.toLowerCase() === 'pre') toggle_vis(y);
  }

    var elem = document.getElementById("myButton1");
    if (elem.value === "Hide Code") elem.value = "Show Code";
    else elem.value = "Hide Code";
}

document.write('<input onclick="toggle_R();" type="button" value="Hide Code" id="myButton1" style="position: absolute; top: 10%; right: 2%; z-index: 200"></input>')

</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#objective"><i class="fa fa-check"></i><b>1.1</b> Objective</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="processing.html"><a href="processing.html"><i class="fa fa-check"></i><b>2</b> Point Cloud Processing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="processing.html"><a href="processing.html#data-location"><i class="fa fa-check"></i><b>2.1</b> Data Location</a></li>
<li class="chapter" data-level="2.2" data-path="processing.html"><a href="processing.html#point-cloud-to-raster-cloud2raster"><i class="fa fa-check"></i><b>2.2</b> Point Cloud to Raster: <code>cloud2raster()</code></a></li>
<li class="chapter" data-level="2.3" data-path="processing.html"><a href="processing.html#individial-tree-detection-tuning-itd_tuning"><i class="fa fa-check"></i><b>2.3</b> Individial Tree Detection Tuning: <code id="itd">itd_tuning()</code></a></li>
<li class="chapter" data-level="2.4" data-path="processing.html"><a href="processing.html#tree-extraction-raster2trees"><i class="fa fa-check"></i><b>2.4</b> Tree Extraction: <code id="trees">raster2trees()</code></a></li>
<li class="chapter" data-level="2.5" data-path="processing.html"><a href="processing.html#cbh-modeling-trees_cbh"><i class="fa fa-check"></i><b>2.5</b> CBH Modeling: <code>trees_cbh()</code></a></li>
<li class="chapter" data-level="2.6" data-path="processing.html"><a href="processing.html#dbh-modeling-trees_dbh"><i class="fa fa-check"></i><b>2.6</b> DBH Modeling: <code>trees_dbh()</code></a></li>
<li class="chapter" data-level="2.7" data-path="processing.html"><a href="processing.html#hmd-modeling-trees_hmd"><i class="fa fa-check"></i><b>2.7</b> HMD Modeling: <code>trees_hmd()</code></a></li>
<li class="chapter" data-level="2.8" data-path="processing.html"><a href="processing.html#forest-type-trees_type"><i class="fa fa-check"></i><b>2.8</b> Forest Type: <code id="trees_type">trees_type()</code></a></li>
<li class="chapter" data-level="2.9" data-path="processing.html"><a href="processing.html#combine-data"><i class="fa fa-check"></i><b>2.9</b> Combine data</a></li>
<li class="chapter" data-level="2.10" data-path="processing.html"><a href="processing.html#crown-biomass-trees_biomass"><i class="fa fa-check"></i><b>2.10</b> Crown Biomass: <code id="trees_biomass">trees_biomass()</code></a></li>
<li class="chapter" data-level="2.11" data-path="processing.html"><a href="processing.html#processing-time-summary"><i class="fa fa-check"></i><b>2.11</b> Processing Time Summary</a></li>
<li class="chapter" data-level="2.12" data-path="processing.html"><a href="processing.html#data-export"><i class="fa fa-check"></i><b>2.12</b> Data Export</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="slash-piles.html"><a href="slash-piles.html"><i class="fa fa-check"></i><b>3</b> Slash Piles</a>
<ul>
<li class="chapter" data-level="3.1" data-path="slash-piles.html"><a href="slash-piles.html#slash-pile-detection-workflow"><i class="fa fa-check"></i><b>3.1</b> Slash Pile Detection Workflow</a></li>
<li class="chapter" data-level="3.2" data-path="slash-piles.html"><a href="slash-piles.html#candidate-pile-review"><i class="fa fa-check"></i><b>3.2</b> Candidate Pile Review</a></li>
<li class="chapter" data-level="3.3" data-path="slash-piles.html"><a href="slash-piles.html#slash-pile-summary-statistics"><i class="fa fa-check"></i><b>3.3</b> Slash Pile Summary Statistics</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html"><i class="fa fa-check"></i><b>4</b> Treatment Unit Silvicultural Summary</a>
<ul>
<li class="chapter" data-level="4.1" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#remove-slash-piles"><i class="fa fa-check"></i><b>4.1</b> Remove Slash Piles</a></li>
<li class="chapter" data-level="4.2" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#function-to-calculate-silviclutural-metrics"><i class="fa fa-check"></i><b>4.2</b> Function to Calculate Silviclutural Metrics</a></li>
<li class="chapter" data-level="4.3" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#treatment-unit-summaries"><i class="fa fa-check"></i><b>4.3</b> Treatment Unit Summaries</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#tabular"><i class="fa fa-check"></i><b>4.3.1</b> Tabular</a></li>
<li class="chapter" data-level="4.3.2" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#visual"><i class="fa fa-check"></i><b>4.3.2</b> Visual</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="treatment-unit-silvicultural-summary.html"><a href="treatment-unit-silvicultural-summary.html#tree-distribution-by-treatment-type"><i class="fa fa-check"></i><b>4.4</b> Tree Distribution by Treatment Type</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BLM Tres Rios Field Office: Dawson project area UAS data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="slash-piles" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Section 3</span> Slash Piles<a href="slash-piles.html#slash-piles" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we’re going to detect slash piles from the CHM over the data extent and use RGB data to spectrally refine pile predictions. The objective is to use pile predictions as a mask to remove smaller, detected “trees” that are actually piles or downed trees/debris.</p>
<div id="slash-pile-detection-workflow" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Slash Pile Detection Workflow<a href="slash-piles.html#slash-pile-detection-workflow" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>make sure we have the fine-resolution CHM and RGB data ready to go</p>
<p>RGB</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="slash-piles.html#cb115-1" tabindex="-1"></a><span class="co"># hey rgb</span></span>
<span id="cb115-2"><a href="slash-piles.html#cb115-2" tabindex="-1"></a>rgb_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(rgb_rast_fnm) <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="slash-piles.html#cb115-3" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">subset</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb115-4"><a href="slash-piles.html#cb115-4" tabindex="-1"></a>rgb_rast</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 105962, 163076, 3  (nrow, ncol, nlyr)
## resolution  : 0.025883, 0.025883  (x, y)
## extent      : 706698.8, 710919.7, 4191874, 4194616  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83(2011) / UTM zone 12N (EPSG:6341) 
## source      : BLM_CO_SWDF_DawsonFuelsTreatment_Ortho_202504.tif 
## names       : Red, Green, Blue</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="slash-piles.html#cb117-1" tabindex="-1"></a><span class="co"># terra::plotRGB(rgb_rast)</span></span></code></pre></div>
<p>CHM</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="slash-piles.html#cb118-1" tabindex="-1"></a><span class="co"># fine-resolution CHM raster</span></span>
<span id="cb118-2"><a href="slash-piles.html#cb118-2" tabindex="-1"></a>chm_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>( <span class="fu">file.path</span>(c2t_process_dir, <span class="st">&quot;chm_0.1m.tif&quot;</span>) )</span>
<span id="cb118-3"><a href="slash-piles.html#cb118-3" tabindex="-1"></a>chm_rast</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 27426, 42203, 1  (nrow, ncol, nlyr)
## resolution  : 0.1, 0.1  (x, y)
## extent      : 706698.8, 710919.1, 4191874, 4194616  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83(2011) / UTM zone 12N (EPSG:6341) 
## source      : chm_0.1m.tif 
## name        : focal_mean 
## min value   :       0.00 
## max value   :      22.59</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="slash-piles.html#cb120-1" tabindex="-1"></a><span class="co"># chm_rast %&gt;% terra::plot(col = viridis::plasma(n=100), main = &quot;CHM (m)&quot;)</span></span></code></pre></div>
<p>load the treatment unit boundaries</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="slash-piles.html#cb121-1" tabindex="-1"></a>stand_boundary <span class="ot">&lt;-</span> </span>
<span id="cb121-2"><a href="slash-piles.html#cb121-2" tabindex="-1"></a>  <span class="st">&quot;c:/data/usfs/slash_pile_detecting/data/Dawson_Data/units/units.shp&quot;</span> <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="slash-piles.html#cb121-3" tabindex="-1"></a>  <span class="co"># &quot;d:/BLM_CO_SWDF_DawsonFuelsTreatment/units/units.shp&quot; %&gt;% </span></span>
<span id="cb121-4"><a href="slash-piles.html#cb121-4" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_read</span>(<span class="at">quiet=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb121-5"><a href="slash-piles.html#cb121-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(tolower) <span class="sc">%&gt;%</span> </span>
<span id="cb121-6"><a href="slash-piles.html#cb121-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(stringr<span class="sc">::</span>str_squish) <span class="sc">%&gt;%</span> </span>
<span id="cb121-7"><a href="slash-piles.html#cb121-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(make.names) <span class="sc">%&gt;%</span> </span>
<span id="cb121-8"><a href="slash-piles.html#cb121-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span>stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(.x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.{2,}&quot;</span>, <span class="st">&quot;.&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-9"><a href="slash-piles.html#cb121-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span>stringr<span class="sc">::</span><span class="fu">str_remove</span>(.x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.$&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-10"><a href="slash-piles.html#cb121-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="sc">~</span>stringr<span class="sc">::</span><span class="fu">str_replace_all</span>(.x, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>, <span class="st">&quot;_&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-11"><a href="slash-piles.html#cb121-11" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="st">&quot;geometry&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb121-12"><a href="slash-piles.html#cb121-12" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(terra<span class="sc">::</span><span class="fu">crs</span>(chm_rast)) <span class="sc">%&gt;%</span> </span>
<span id="cb121-13"><a href="slash-piles.html#cb121-13" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb121-14"><a href="slash-piles.html#cb121-14" tabindex="-1"></a>    <span class="at">unit_area_ha =</span> <span class="fu">as.numeric</span>(sf<span class="sc">::</span><span class="fu">st_area</span>(geometry))<span class="sc">/</span><span class="dv">10000</span></span>
<span id="cb121-15"><a href="slash-piles.html#cb121-15" tabindex="-1"></a>  )</span>
<span id="cb121-16"><a href="slash-piles.html#cb121-16" tabindex="-1"></a><span class="co"># stand_boundary %&gt;% dplyr::glimpse()</span></span></code></pre></div>
<p>what treatments are there?</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="slash-piles.html#cb122-1" tabindex="-1"></a>stand_boundary <span class="sc">%&gt;%</span> </span>
<span id="cb122-2"><a href="slash-piles.html#cb122-2" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb122-3"><a href="slash-piles.html#cb122-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(tretmnt)</span></code></pre></div>
<pre><code>##         tretmnt  n
## 1       Control 12
## 2  Heterogenous 12
## 3 Uniform- HIgh 12
## 4  Uniform- Low 12</code></pre>
<p>plot the stands on the CHM</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="slash-piles.html#cb124-1" tabindex="-1"></a>chm_rast <span class="sc">%&gt;%</span> </span>
<span id="cb124-2"><a href="slash-piles.html#cb124-2" tabindex="-1"></a>  <span class="co"># terra::aggregate(fact = 2, fun=&quot;max&quot;,na.rm=T,cores=lasR::half_cores()) %&gt;% </span></span>
<span id="cb124-3"><a href="slash-piles.html#cb124-3" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">plot</span>(<span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">plasma</span>(<span class="at">n=</span><span class="dv">100</span>), <span class="at">main =</span> <span class="st">&quot;CHM (m)&quot;</span>, <span class="at">axes =</span> F)</span>
<span id="cb124-4"><a href="slash-piles.html#cb124-4" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(</span>
<span id="cb124-5"><a href="slash-piles.html#cb124-5" tabindex="-1"></a>    stand_boundary <span class="sc">%&gt;%</span> terra<span class="sc">::</span><span class="fu">vect</span>()</span>
<span id="cb124-6"><a href="slash-piles.html#cb124-6" tabindex="-1"></a>    , <span class="at">add =</span> T, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span></span>
<span id="cb124-7"><a href="slash-piles.html#cb124-7" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-97-1.png" alt="" width="1008" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="slash-piles.html#cb125-1" tabindex="-1"></a><span class="co"># stand_boundary %&gt;% </span></span>
<span id="cb125-2"><a href="slash-piles.html#cb125-2" tabindex="-1"></a><span class="co">#   dplyr::ungroup() %&gt;% </span></span>
<span id="cb125-3"><a href="slash-piles.html#cb125-3" tabindex="-1"></a><span class="co">#   sf::st_union() %&gt;%</span></span>
<span id="cb125-4"><a href="slash-piles.html#cb125-4" tabindex="-1"></a><span class="co">#   sf::st_convex_hull() %&gt;% </span></span>
<span id="cb125-5"><a href="slash-piles.html#cb125-5" tabindex="-1"></a><span class="co">#   sf::st_buffer(25) %&gt;% </span></span>
<span id="cb125-6"><a href="slash-piles.html#cb125-6" tabindex="-1"></a><span class="co">#   terra::vect() %&gt;% </span></span>
<span id="cb125-7"><a href="slash-piles.html#cb125-7" tabindex="-1"></a><span class="co">#   terra::plot(</span></span>
<span id="cb125-8"><a href="slash-piles.html#cb125-8" tabindex="-1"></a><span class="co">#     add = T, border = &quot;red&quot;, col = NA, lwd = 2</span></span>
<span id="cb125-9"><a href="slash-piles.html#cb125-9" tabindex="-1"></a><span class="co">#   )</span></span></code></pre></div>
<p>let’s crop the RGB and CHM to limit the amount of data we need to process</p>
<p>we’ll also make the RGB data more coarse since we only need ~0.06-0.1 m resolution data for the spectral filtering step in the pile detection workflow</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="slash-piles.html#cb126-1" tabindex="-1"></a><span class="co"># outside boundary of stand units with buffer</span></span>
<span id="cb126-2"><a href="slash-piles.html#cb126-2" tabindex="-1"></a>crop_bound_temp <span class="ot">&lt;-</span> stand_boundary <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="slash-piles.html#cb126-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-4"><a href="slash-piles.html#cb126-4" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_union</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-5"><a href="slash-piles.html#cb126-5" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_convex_hull</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-6"><a href="slash-piles.html#cb126-6" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_buffer</span>(<span class="dv">25</span>)</span>
<span id="cb126-7"><a href="slash-piles.html#cb126-7" tabindex="-1"></a><span class="do">## function to change the resolution of RGB </span></span>
<span id="cb126-8"><a href="slash-piles.html#cb126-8" tabindex="-1"></a>change_res_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb126-9"><a href="slash-piles.html#cb126-9" tabindex="-1"></a>  r</span>
<span id="cb126-10"><a href="slash-piles.html#cb126-10" tabindex="-1"></a>  , <span class="at">my_res=</span><span class="dv">1</span></span>
<span id="cb126-11"><a href="slash-piles.html#cb126-11" tabindex="-1"></a>  , <span class="at">m =</span> <span class="st">&quot;bilinear&quot;</span></span>
<span id="cb126-12"><a href="slash-piles.html#cb126-12" tabindex="-1"></a>  <span class="co"># , ofile = tempfile(fileext = &quot;.tif&quot;)</span></span>
<span id="cb126-13"><a href="slash-piles.html#cb126-13" tabindex="-1"></a>  , <span class="at">ofile =</span> <span class="cn">NULL</span></span>
<span id="cb126-14"><a href="slash-piles.html#cb126-14" tabindex="-1"></a>){</span>
<span id="cb126-15"><a href="slash-piles.html#cb126-15" tabindex="-1"></a>  <span class="cf">if</span>(terra<span class="sc">::</span><span class="fu">res</span>(r)[<span class="dv">1</span>] <span class="sc">==</span> my_res){</span>
<span id="cb126-16"><a href="slash-piles.html#cb126-16" tabindex="-1"></a>    <span class="fu">return</span>(r)</span>
<span id="cb126-17"><a href="slash-piles.html#cb126-17" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb126-18"><a href="slash-piles.html#cb126-18" tabindex="-1"></a>    r2 <span class="ot">&lt;-</span> r</span>
<span id="cb126-19"><a href="slash-piles.html#cb126-19" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">res</span>(r2) <span class="ot">&lt;-</span> my_res</span>
<span id="cb126-20"><a href="slash-piles.html#cb126-20" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">inherits</span>(ofile,<span class="st">&quot;character&quot;</span>)){</span>
<span id="cb126-21"><a href="slash-piles.html#cb126-21" tabindex="-1"></a>      r2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">resample</span>(r, r2, <span class="at">method =</span> m) </span>
<span id="cb126-22"><a href="slash-piles.html#cb126-22" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb126-23"><a href="slash-piles.html#cb126-23" tabindex="-1"></a>      r2 <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">resample</span>(r, r2, <span class="at">method =</span> m, <span class="at">filename=</span>ofile, <span class="at">overwrite =</span> T) </span>
<span id="cb126-24"><a href="slash-piles.html#cb126-24" tabindex="-1"></a>    }</span>
<span id="cb126-25"><a href="slash-piles.html#cb126-25" tabindex="-1"></a>    <span class="fu">return</span>(r2) </span>
<span id="cb126-26"><a href="slash-piles.html#cb126-26" tabindex="-1"></a>  }</span>
<span id="cb126-27"><a href="slash-piles.html#cb126-27" tabindex="-1"></a>}</span>
<span id="cb126-28"><a href="slash-piles.html#cb126-28" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb126-29"><a href="slash-piles.html#cb126-29" tabindex="-1"></a><span class="co"># clip rgb to boundary and resample to change resolution</span></span>
<span id="cb126-30"><a href="slash-piles.html#cb126-30" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb126-31"><a href="slash-piles.html#cb126-31" tabindex="-1"></a>dir_temp <span class="ot">&lt;-</span> c2t_process_dir</span>
<span id="cb126-32"><a href="slash-piles.html#cb126-32" tabindex="-1"></a>rgb_fnm_temp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_temp,<span class="st">&quot;pj_rgb_rast.tif&quot;</span>) <span class="co"># what should the compiled rgb be called?</span></span>
<span id="cb126-33"><a href="slash-piles.html#cb126-33" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(dir_temp)){<span class="fu">dir.create</span>(dir_temp, <span class="at">showWarnings =</span> F)}</span>
<span id="cb126-34"><a href="slash-piles.html#cb126-34" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(rgb_fnm_temp)){</span>
<span id="cb126-35"><a href="slash-piles.html#cb126-35" tabindex="-1"></a>  <span class="co"># Crop the raster to the rectangular extent of the polygon</span></span>
<span id="cb126-36"><a href="slash-piles.html#cb126-36" tabindex="-1"></a>  <span class="co"># Specify a filename to ensure the result is written to disk</span></span>
<span id="cb126-37"><a href="slash-piles.html#cb126-37" tabindex="-1"></a>  crop_rgb_rast_temp <span class="ot">&lt;-</span> rgb_rast <span class="sc">%&gt;%</span> </span>
<span id="cb126-38"><a href="slash-piles.html#cb126-38" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb126-39"><a href="slash-piles.html#cb126-39" tabindex="-1"></a>      crop_bound_temp <span class="sc">%&gt;%</span> </span>
<span id="cb126-40"><a href="slash-piles.html#cb126-40" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">vect</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-41"><a href="slash-piles.html#cb126-41" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">project</span>(terra<span class="sc">::</span><span class="fu">crs</span>(rgb_rast))</span>
<span id="cb126-42"><a href="slash-piles.html#cb126-42" tabindex="-1"></a>      , <span class="at">filename =</span>  <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.tif&quot;</span>)</span>
<span id="cb126-43"><a href="slash-piles.html#cb126-43" tabindex="-1"></a>      , <span class="at">mask =</span> T</span>
<span id="cb126-44"><a href="slash-piles.html#cb126-44" tabindex="-1"></a>      , <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb126-45"><a href="slash-piles.html#cb126-45" tabindex="-1"></a>    ) </span>
<span id="cb126-46"><a href="slash-piles.html#cb126-46" tabindex="-1"></a>  </span>
<span id="cb126-47"><a href="slash-piles.html#cb126-47" tabindex="-1"></a>  <span class="do">## apply the change_res_fn for our analysis we don&#39;t need such finery</span></span>
<span id="cb126-48"><a href="slash-piles.html#cb126-48" tabindex="-1"></a>  <span class="co"># this takes too long...</span></span>
<span id="cb126-49"><a href="slash-piles.html#cb126-49" tabindex="-1"></a>  rgb_rast <span class="ot">&lt;-</span> <span class="fu">change_res_fn</span>(rgb_rast, <span class="at">my_res=</span><span class="fl">0.06</span>, <span class="at">ofile =</span> rgb_fnm_temp)</span>
<span id="cb126-50"><a href="slash-piles.html#cb126-50" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb126-51"><a href="slash-piles.html#cb126-51" tabindex="-1"></a>  rgb_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(rgb_fnm_temp)</span>
<span id="cb126-52"><a href="slash-piles.html#cb126-52" tabindex="-1"></a>}</span>
<span id="cb126-53"><a href="slash-piles.html#cb126-53" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb126-54"><a href="slash-piles.html#cb126-54" tabindex="-1"></a><span class="co"># clip chm to boundary</span></span>
<span id="cb126-55"><a href="slash-piles.html#cb126-55" tabindex="-1"></a><span class="do">###############################################################</span></span>
<span id="cb126-56"><a href="slash-piles.html#cb126-56" tabindex="-1"></a>chm_fnm_temp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(dir_temp, <span class="fu">paste0</span>(<span class="st">&quot;crop_&quot;</span>,<span class="fu">basename</span>(terra<span class="sc">::</span><span class="fu">sources</span>(chm_rast))) ) <span class="co"># what should the compiled rgb be called?</span></span>
<span id="cb126-57"><a href="slash-piles.html#cb126-57" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">dir.exists</span>(dir_temp)){<span class="fu">dir.create</span>(dir_temp, <span class="at">showWarnings =</span> F)}</span>
<span id="cb126-58"><a href="slash-piles.html#cb126-58" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(chm_fnm_temp)){</span>
<span id="cb126-59"><a href="slash-piles.html#cb126-59" tabindex="-1"></a>  <span class="co"># Crop the raster to the rectangular extent of the polygon</span></span>
<span id="cb126-60"><a href="slash-piles.html#cb126-60" tabindex="-1"></a>  <span class="co"># Specify a filename to ensure the result is written to disk</span></span>
<span id="cb126-61"><a href="slash-piles.html#cb126-61" tabindex="-1"></a>  chm_rast <span class="ot">&lt;-</span> chm_rast <span class="sc">%&gt;%</span> </span>
<span id="cb126-62"><a href="slash-piles.html#cb126-62" tabindex="-1"></a>    terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb126-63"><a href="slash-piles.html#cb126-63" tabindex="-1"></a>      crop_bound_temp <span class="sc">%&gt;%</span> </span>
<span id="cb126-64"><a href="slash-piles.html#cb126-64" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">vect</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb126-65"><a href="slash-piles.html#cb126-65" tabindex="-1"></a>        terra<span class="sc">::</span><span class="fu">project</span>(terra<span class="sc">::</span><span class="fu">crs</span>(chm_rast))</span>
<span id="cb126-66"><a href="slash-piles.html#cb126-66" tabindex="-1"></a>      , <span class="at">filename =</span> chm_fnm_temp</span>
<span id="cb126-67"><a href="slash-piles.html#cb126-67" tabindex="-1"></a>      , <span class="at">mask =</span> T</span>
<span id="cb126-68"><a href="slash-piles.html#cb126-68" tabindex="-1"></a>      , <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb126-69"><a href="slash-piles.html#cb126-69" tabindex="-1"></a>    ) </span>
<span id="cb126-70"><a href="slash-piles.html#cb126-70" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb126-71"><a href="slash-piles.html#cb126-71" tabindex="-1"></a>  chm_rast <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(chm_fnm_temp)</span>
<span id="cb126-72"><a href="slash-piles.html#cb126-72" tabindex="-1"></a>}</span></code></pre></div>
<p>check the new raster data</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="slash-piles.html#cb127-1" tabindex="-1"></a>rgb_rast</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 45710, 70348, 3  (nrow, ncol, nlyr)
## resolution  : 0.06, 0.06  (x, y)
## extent      : 706698.8, 710919.7, 4191874, 4194616  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83(2011) / UTM zone 12N (EPSG:6341) 
## source      : pj_rgb_rast.tif 
## names       :      Red,    Green,     Blue 
## min values  :   0.0000,   0.0000,   0.0000 
## max values  : 253.1589, 251.0938, 248.0194</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="slash-piles.html#cb129-1" tabindex="-1"></a>chm_rast</span></code></pre></div>
<pre><code>## class       : SpatRaster 
## size        : 25292, 39925, 1  (nrow, ncol, nlyr)
## resolution  : 0.1, 0.1  (x, y)
## extent      : 706801.4, 710793.9, 4192002, 4194532  (xmin, xmax, ymin, ymax)
## coord. ref. : NAD83(2011) / UTM zone 12N (EPSG:6341) 
## source      : crop_chm_0.1m.tif 
## name        : focal_mean 
## min value   :       0.00 
## max value   :      22.59</code></pre>
<p>run the piles detection workflow using <code>cloud2trees:::piles_workflow()</code>; note, the <code>:::</code> implies the functionality is internal to the package</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="slash-piles.html#cb131-1" tabindex="-1"></a>fnm_temp <span class="ot">&lt;-</span> <span class="fu">file.path</span>(c2t_process_dir,<span class="st">&quot;piles_detect.gpkg&quot;</span>)</span>
<span id="cb131-2"><a href="slash-piles.html#cb131-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(fnm_temp)){</span>
<span id="cb131-3"><a href="slash-piles.html#cb131-3" tabindex="-1"></a>  piles_workflow_ans <span class="ot">&lt;-</span> cloud2trees<span class="sc">:::</span><span class="fu">piles_workflow</span>(</span>
<span id="cb131-4"><a href="slash-piles.html#cb131-4" tabindex="-1"></a>    <span class="at">chm_rast =</span> chm_rast</span>
<span id="cb131-5"><a href="slash-piles.html#cb131-5" tabindex="-1"></a>    , <span class="at">seg_method =</span> <span class="st">&quot;watershed&quot;</span></span>
<span id="cb131-6"><a href="slash-piles.html#cb131-6" tabindex="-1"></a>    , <span class="at">min_ht_m =</span> <span class="fl">0.75</span></span>
<span id="cb131-7"><a href="slash-piles.html#cb131-7" tabindex="-1"></a>    , <span class="at">max_ht_m =</span> <span class="fl">3.0</span></span>
<span id="cb131-8"><a href="slash-piles.html#cb131-8" tabindex="-1"></a>    , <span class="at">min_area_m2 =</span> <span class="fl">2.0</span></span>
<span id="cb131-9"><a href="slash-piles.html#cb131-9" tabindex="-1"></a>    , <span class="at">max_area_m2 =</span> <span class="fl">22.5</span></span>
<span id="cb131-10"><a href="slash-piles.html#cb131-10" tabindex="-1"></a>    , <span class="at">min_convexity_ratio =</span> <span class="fl">0.55</span></span>
<span id="cb131-11"><a href="slash-piles.html#cb131-11" tabindex="-1"></a>    , <span class="at">min_circularity_ratio =</span> <span class="fl">0.35</span></span>
<span id="cb131-12"><a href="slash-piles.html#cb131-12" tabindex="-1"></a>    , <span class="at">smooth_segs =</span> T</span>
<span id="cb131-13"><a href="slash-piles.html#cb131-13" tabindex="-1"></a>    , <span class="at">outfile =</span> fnm_temp</span>
<span id="cb131-14"><a href="slash-piles.html#cb131-14" tabindex="-1"></a>    , <span class="at">spectral_weight =</span> <span class="dv">5</span></span>
<span id="cb131-15"><a href="slash-piles.html#cb131-15" tabindex="-1"></a>    , <span class="at">rgb_rast =</span> rgb_rast</span>
<span id="cb131-16"><a href="slash-piles.html#cb131-16" tabindex="-1"></a>    , <span class="at">red_band_idx =</span> <span class="dv">1</span></span>
<span id="cb131-17"><a href="slash-piles.html#cb131-17" tabindex="-1"></a>    , <span class="at">green_band_idx =</span> <span class="dv">2</span></span>
<span id="cb131-18"><a href="slash-piles.html#cb131-18" tabindex="-1"></a>    , <span class="at">blue_band_idx =</span> <span class="dv">3</span></span>
<span id="cb131-19"><a href="slash-piles.html#cb131-19" tabindex="-1"></a>    , <span class="at">filter_return =</span> F</span>
<span id="cb131-20"><a href="slash-piles.html#cb131-20" tabindex="-1"></a>  )</span>
<span id="cb131-21"><a href="slash-piles.html#cb131-21" tabindex="-1"></a>  <span class="co"># just get the piles</span></span>
<span id="cb131-22"><a href="slash-piles.html#cb131-22" tabindex="-1"></a>  piles_workflow_ans <span class="ot">&lt;-</span> piles_workflow_ans<span class="sc">$</span>segs_sf</span>
<span id="cb131-23"><a href="slash-piles.html#cb131-23" tabindex="-1"></a>}<span class="cf">else</span>{</span>
<span id="cb131-24"><a href="slash-piles.html#cb131-24" tabindex="-1"></a>  piles_workflow_ans <span class="ot">&lt;-</span> sf<span class="sc">::</span><span class="fu">st_read</span>(fnm_temp, <span class="at">quiet =</span> T)</span>
<span id="cb131-25"><a href="slash-piles.html#cb131-25" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="candidate-pile-review" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Candidate Pile Review<a href="slash-piles.html#candidate-pile-review" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>we should have gotten a list of candidate slash pile locations which we’ll spectrally filter after we look at a few examples</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="slash-piles.html#cb132-1" tabindex="-1"></a>piles_workflow_ans <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## Rows: 50,886
## Columns: 22
## $ pred_id            &lt;dbl&gt; 3, 68, 75, 143, 151, 178, 227, 229, 343, 366, 510, …
## $ convexity_ratio    &lt;dbl&gt; 0.6850095, 0.7985560, 0.8740648, 0.8054011, 0.69533…
## $ circularity_ratio  &lt;dbl&gt; 0.4366637, 0.4346449, 0.4641106, 0.4544880, 0.41981…
## $ area_m2            &lt;dbl&gt; 5.270, 6.925, 8.020, 6.295, 5.465, 3.465, 10.045, 2…
## $ volume_m3          &lt;dbl&gt; 12.931723, 15.023012, 12.628348, 10.460978, 12.5403…
## $ max_height_m       &lt;dbl&gt; 3.000000, 2.930000, 2.830000, 3.000000, 3.000000, 3…
## $ volume_per_area    &lt;dbl&gt; 2.4538374, 2.1693880, 1.5746070, 1.6617915, 2.29465…
## $ diameter_m         &lt;dbl&gt; 3.238827, 3.900000, 4.386342, 3.769615, 3.395585, 2…
## $ rast_agg_grvi      &lt;dbl&gt; 1.852449e-02, 1.391539e-02, 6.146593e-03, -2.349146…
## $ rast_agg_rgri      &lt;dbl&gt; 0.9636249, 0.9725512, 0.9877819, 1.0000470, 1.00835…
## $ rast_agg_vdvi      &lt;dbl&gt; 0.044285724, 0.060734405, 0.066752846, 0.014706555,…
## $ rast_agg_exgr      &lt;dbl&gt; -0.065313345, -0.045324605, -0.049583234, -0.116836…
## $ rast_agg_Lab_a     &lt;dbl&gt; -4.0581156, -5.5319379, -5.4390111, -0.9861935, -1.…
## $ rast_agg_hsv_hue   &lt;dbl&gt; 74.35908, 67.03060, 62.75708, 68.82339, 56.30680, 6…
## $ inrange_th_grvi    &lt;int&gt; 0, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, …
## $ inrange_th_rgri    &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ inrange_th_vdvi    &lt;int&gt; 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 0, 0, 1, …
## $ inrange_th_exgr    &lt;int&gt; 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ inrange_th_Lab_a   &lt;int&gt; 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, …
## $ inrange_th_hsv_hue &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 1, …
## $ inrange_th_votes   &lt;dbl&gt; 3, 2, 2, 5, 4, 3, 1, 6, 2, 4, 2, 6, 5, 6, 4, 2, 6, …
## $ geom               &lt;POLYGON [m]&gt; POLYGON ((708386.8 4194402,..., POLYGON ((7…</code></pre>
<p>lets zoom-in on a single stand to look at the candidate pile locations in blue within the unit on the CHM</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="slash-piles.html#cb134-1" tabindex="-1"></a>chm_rast <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="slash-piles.html#cb134-2" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb134-3"><a href="slash-piles.html#cb134-3" tabindex="-1"></a>    stand_boundary <span class="sc">%&gt;%</span></span>
<span id="cb134-4"><a href="slash-piles.html#cb134-4" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tolower</span>(tretmnt)<span class="sc">!=</span><span class="st">&quot;control&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-5"><a href="slash-piles.html#cb134-5" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-6"><a href="slash-piles.html#cb134-6" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_transform</span>(terra<span class="sc">::</span><span class="fu">crs</span>(chm_rast)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-7"><a href="slash-piles.html#cb134-7" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_buffer</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-8"><a href="slash-piles.html#cb134-8" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">vect</span>()</span>
<span id="cb134-9"><a href="slash-piles.html#cb134-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb134-10"><a href="slash-piles.html#cb134-10" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">plot</span>(<span class="at">col =</span> viridis<span class="sc">::</span><span class="fu">plasma</span>(<span class="at">n=</span><span class="dv">100</span>), <span class="at">main =</span> <span class="st">&quot;CHM (m)&quot;</span>, <span class="at">axes =</span> F)</span>
<span id="cb134-11"><a href="slash-piles.html#cb134-11" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(</span>
<span id="cb134-12"><a href="slash-piles.html#cb134-12" tabindex="-1"></a>    stand_boundary <span class="sc">%&gt;%</span></span>
<span id="cb134-13"><a href="slash-piles.html#cb134-13" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tolower</span>(tretmnt)<span class="sc">!=</span><span class="st">&quot;control&quot;</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> terra<span class="sc">::</span><span class="fu">vect</span>()</span>
<span id="cb134-14"><a href="slash-piles.html#cb134-14" tabindex="-1"></a>    , <span class="at">add =</span> T, <span class="at">border =</span> <span class="st">&quot;black&quot;</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span></span>
<span id="cb134-15"><a href="slash-piles.html#cb134-15" tabindex="-1"></a>  )</span>
<span id="cb134-16"><a href="slash-piles.html#cb134-16" tabindex="-1"></a>piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb134-17"><a href="slash-piles.html#cb134-17" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(inrange_th_votes<span class="sc">&gt;=</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-18"><a href="slash-piles.html#cb134-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb134-19"><a href="slash-piles.html#cb134-19" tabindex="-1"></a>    piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb134-20"><a href="slash-piles.html#cb134-20" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_point_on_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-21"><a href="slash-piles.html#cb134-21" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(stand_boundary)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-22"><a href="slash-piles.html#cb134-22" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb134-23"><a href="slash-piles.html#cb134-23" tabindex="-1"></a>      stand_boundary <span class="sc">%&gt;%</span></span>
<span id="cb134-24"><a href="slash-piles.html#cb134-24" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">tolower</span>(tretmnt)<span class="sc">!=</span><span class="st">&quot;control&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb134-25"><a href="slash-piles.html#cb134-25" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span>)</span>
<span id="cb134-26"><a href="slash-piles.html#cb134-26" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb134-27"><a href="slash-piles.html#cb134-27" tabindex="-1"></a>    sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-28"><a href="slash-piles.html#cb134-28" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(pred_id)</span>
<span id="cb134-29"><a href="slash-piles.html#cb134-29" tabindex="-1"></a>    , <span class="at">by =</span> <span class="st">&quot;pred_id&quot;</span></span>
<span id="cb134-30"><a href="slash-piles.html#cb134-30" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb134-31"><a href="slash-piles.html#cb134-31" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(terra<span class="sc">::</span><span class="fu">crs</span>(chm_rast)) <span class="sc">%&gt;%</span> </span>
<span id="cb134-32"><a href="slash-piles.html#cb134-32" tabindex="-1"></a>  terra<span class="sc">::</span><span class="fu">vect</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-33"><a href="slash-piles.html#cb134-33" tabindex="-1"></a>terra<span class="sc">::</span><span class="fu">plot</span>(</span>
<span id="cb134-34"><a href="slash-piles.html#cb134-34" tabindex="-1"></a>    <span class="at">add =</span> T, <span class="at">border =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.8</span></span>
<span id="cb134-35"><a href="slash-piles.html#cb134-35" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-104-1.png" alt="" width="1008" /></p>
<p>filter for piles only in treatment units since we don’t expect piles in non-treated areas</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="slash-piles.html#cb135-1" tabindex="-1"></a>piles_workflow_ans <span class="ot">&lt;-</span></span>
<span id="cb135-2"><a href="slash-piles.html#cb135-2" tabindex="-1"></a>  piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb135-3"><a href="slash-piles.html#cb135-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb135-4"><a href="slash-piles.html#cb135-4" tabindex="-1"></a>    piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb135-5"><a href="slash-piles.html#cb135-5" tabindex="-1"></a>      <span class="co"># pile determined in unit based on polygon center</span></span>
<span id="cb135-6"><a href="slash-piles.html#cb135-6" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_point_on_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb135-7"><a href="slash-piles.html#cb135-7" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_transform</span>(sf<span class="sc">::</span><span class="fu">st_crs</span>(stand_boundary)) <span class="sc">%&gt;%</span> </span>
<span id="cb135-8"><a href="slash-piles.html#cb135-8" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_intersection</span>(</span>
<span id="cb135-9"><a href="slash-piles.html#cb135-9" tabindex="-1"></a>        stand_boundary <span class="sc">%&gt;%</span></span>
<span id="cb135-10"><a href="slash-piles.html#cb135-10" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">select</span>(unit,block,tretmnt,unit_area_ha) <span class="sc">%&gt;%</span> </span>
<span id="cb135-11"><a href="slash-piles.html#cb135-11" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">type =</span> tretmnt) <span class="sc">%&gt;%</span> </span>
<span id="cb135-12"><a href="slash-piles.html#cb135-12" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb135-13"><a href="slash-piles.html#cb135-13" tabindex="-1"></a>            <span class="at">type =</span></span>
<span id="cb135-14"><a href="slash-piles.html#cb135-14" tabindex="-1"></a>              <span class="fu">tolower</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb135-15"><a href="slash-piles.html#cb135-15" tabindex="-1"></a>              stringr<span class="sc">::</span><span class="fu">str_squish</span>()</span>
<span id="cb135-16"><a href="slash-piles.html#cb135-16" tabindex="-1"></a>          ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-17"><a href="slash-piles.html#cb135-17" tabindex="-1"></a>          dplyr<span class="sc">::</span><span class="fu">rename_with</span>(<span class="at">.fn =</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">&quot;trtmnt_&quot;</span>, .x, <span class="at">recycle0 =</span> T))</span>
<span id="cb135-18"><a href="slash-piles.html#cb135-18" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-19"><a href="slash-piles.html#cb135-19" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb135-20"><a href="slash-piles.html#cb135-20" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(pred_id, tidyselect<span class="sc">::</span><span class="fu">starts_with</span>(<span class="st">&quot;trtmnt_&quot;</span>))</span>
<span id="cb135-21"><a href="slash-piles.html#cb135-21" tabindex="-1"></a>    , <span class="at">by =</span> <span class="st">&quot;pred_id&quot;</span></span>
<span id="cb135-22"><a href="slash-piles.html#cb135-22" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb135-23"><a href="slash-piles.html#cb135-23" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb135-24"><a href="slash-piles.html#cb135-24" tabindex="-1"></a>    <span class="at">is_in_trtmnt_unit =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(trtmnt_type) <span class="sc">|</span> trtmnt_type<span class="sc">==</span><span class="st">&quot;control&quot;</span>,F,T)</span>
<span id="cb135-25"><a href="slash-piles.html#cb135-25" tabindex="-1"></a>  )</span></code></pre></div>
<p>quick summary by treatment type</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="slash-piles.html#cb136-1" tabindex="-1"></a>piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb136-2"><a href="slash-piles.html#cb136-2" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="slash-piles.html#cb136-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">count</span>(is_in_trtmnt_unit, trtmnt_type)</span></code></pre></div>
<pre><code>##   is_in_trtmnt_unit   trtmnt_type     n
## 1             FALSE       control  9615
## 2             FALSE          &lt;NA&gt; 28439
## 3              TRUE  heterogenous  7084
## 4              TRUE uniform- high  2276
## 5              TRUE  uniform- low  3474</code></pre>
<p>let’s look at some candidate piles based on the <code>inrange_th_votes</code> variable which tells us how many of the 6 spectral index thresholds were met to distinguish a dead wood from living biomass. Where, a value of 5-6 represents high likelihood that the object is <em>not</em> living vegetation (e.g. piled slash) and 1-2 indicates a high likelihood that the object is living vegetation (e.g. small tree/shrub)</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="slash-piles.html#cb138-1" tabindex="-1"></a><span class="co"># sample from inrange_th_votes</span></span>
<span id="cb138-2"><a href="slash-piles.html#cb138-2" tabindex="-1"></a>inunit_piles_temp <span class="ot">&lt;-</span></span>
<span id="cb138-3"><a href="slash-piles.html#cb138-3" tabindex="-1"></a>  piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb138-4"><a href="slash-piles.html#cb138-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(is_in_trtmnt_unit) <span class="sc">%&gt;%</span> </span>
<span id="cb138-5"><a href="slash-piles.html#cb138-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(inrange_th_votes) <span class="sc">%&gt;%</span> </span>
<span id="cb138-6"><a href="slash-piles.html#cb138-6" tabindex="-1"></a>  <span class="co"># dplyr::filter(inrange_th_votes&gt;=6) %&gt;% </span></span>
<span id="cb138-7"><a href="slash-piles.html#cb138-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-8"><a href="slash-piles.html#cb138-8" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(terra<span class="sc">::</span><span class="fu">crs</span>(rgb_rast)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-9"><a href="slash-piles.html#cb138-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb138-10"><a href="slash-piles.html#cb138-10" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(inrange_th_votes)</span>
<span id="cb138-11"><a href="slash-piles.html#cb138-11" tabindex="-1"></a><span class="co"># map over to plot</span></span>
<span id="cb138-12"><a href="slash-piles.html#cb138-12" tabindex="-1"></a>plts_temp <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(inunit_piles_temp) <span class="sc">%&gt;%</span> </span>
<span id="cb138-13"><a href="slash-piles.html#cb138-13" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(x){</span>
<span id="cb138-14"><a href="slash-piles.html#cb138-14" tabindex="-1"></a>    sp_temp <span class="ot">&lt;-</span> inunit_piles_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(x)</span>
<span id="cb138-15"><a href="slash-piles.html#cb138-15" tabindex="-1"></a>    rgb_temp <span class="ot">&lt;-</span> </span>
<span id="cb138-16"><a href="slash-piles.html#cb138-16" tabindex="-1"></a>      rgb_rast <span class="sc">%&gt;%</span> </span>
<span id="cb138-17"><a href="slash-piles.html#cb138-17" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb138-18"><a href="slash-piles.html#cb138-18" tabindex="-1"></a>        sp_temp <span class="sc">%&gt;%</span> </span>
<span id="cb138-19"><a href="slash-piles.html#cb138-19" tabindex="-1"></a>          sf<span class="sc">::</span><span class="fu">st_point_on_surface</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb138-20"><a href="slash-piles.html#cb138-20" tabindex="-1"></a>          sf<span class="sc">::</span><span class="fu">st_buffer</span>(<span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb138-21"><a href="slash-piles.html#cb138-21" tabindex="-1"></a>          sf<span class="sc">::</span><span class="fu">st_bbox</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb138-22"><a href="slash-piles.html#cb138-22" tabindex="-1"></a>          sf<span class="sc">::</span><span class="fu">st_as_sfc</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb138-23"><a href="slash-piles.html#cb138-23" tabindex="-1"></a>          terra<span class="sc">::</span><span class="fu">vect</span>()</span>
<span id="cb138-24"><a href="slash-piles.html#cb138-24" tabindex="-1"></a>      )</span>
<span id="cb138-25"><a href="slash-piles.html#cb138-25" tabindex="-1"></a>    <span class="co"># convert raster to a data frame and create hex colors</span></span>
<span id="cb138-26"><a href="slash-piles.html#cb138-26" tabindex="-1"></a>    <span class="co"># ?grDevices::rgb</span></span>
<span id="cb138-27"><a href="slash-piles.html#cb138-27" tabindex="-1"></a>    rgb_df_temp <span class="ot">&lt;-</span></span>
<span id="cb138-28"><a href="slash-piles.html#cb138-28" tabindex="-1"></a>      rgb_temp <span class="sc">%&gt;%</span> </span>
<span id="cb138-29"><a href="slash-piles.html#cb138-29" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">as.data.frame</span>(<span class="at">xy =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb138-30"><a href="slash-piles.html#cb138-30" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb138-31"><a href="slash-piles.html#cb138-31" tabindex="-1"></a>        <span class="at">red =</span> <span class="dv">3</span>, <span class="at">green =</span> <span class="dv">4</span>, <span class="at">blue =</span> <span class="dv">5</span></span>
<span id="cb138-32"><a href="slash-piles.html#cb138-32" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb138-33"><a href="slash-piles.html#cb138-33" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb138-34"><a href="slash-piles.html#cb138-34" tabindex="-1"></a>        <span class="co"># rows that have missing color data</span></span>
<span id="cb138-35"><a href="slash-piles.html#cb138-35" tabindex="-1"></a>        <span class="at">is_missing =</span> <span class="fu">is.na</span>(red) <span class="sc">|</span> <span class="fu">is.na</span>(green) <span class="sc">|</span> <span class="fu">is.na</span>(blue)</span>
<span id="cb138-36"><a href="slash-piles.html#cb138-36" tabindex="-1"></a>        <span class="co"># hex using 0s for NAs to avoid grDevices::rgb error</span></span>
<span id="cb138-37"><a href="slash-piles.html#cb138-37" tabindex="-1"></a>        , <span class="at">hex_col =</span> grDevices<span class="sc">::</span><span class="fu">rgb</span>(</span>
<span id="cb138-38"><a href="slash-piles.html#cb138-38" tabindex="-1"></a>          <span class="fu">ifelse</span>(is_missing, <span class="dv">0</span>, red)</span>
<span id="cb138-39"><a href="slash-piles.html#cb138-39" tabindex="-1"></a>          , <span class="fu">ifelse</span>(is_missing, <span class="dv">0</span>, green)</span>
<span id="cb138-40"><a href="slash-piles.html#cb138-40" tabindex="-1"></a>          , <span class="fu">ifelse</span>(is_missing, <span class="dv">0</span>, blue)</span>
<span id="cb138-41"><a href="slash-piles.html#cb138-41" tabindex="-1"></a>          , <span class="at">maxColorValue =</span> <span class="dv">255</span></span>
<span id="cb138-42"><a href="slash-piles.html#cb138-42" tabindex="-1"></a>        )</span>
<span id="cb138-43"><a href="slash-piles.html#cb138-43" tabindex="-1"></a>        <span class="co"># back to NA</span></span>
<span id="cb138-44"><a href="slash-piles.html#cb138-44" tabindex="-1"></a>        , <span class="at">hex_col =</span> <span class="fu">ifelse</span>(is_missing, <span class="fu">as.character</span>(<span class="cn">NA</span>), hex_col)</span>
<span id="cb138-45"><a href="slash-piles.html#cb138-45" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb138-46"><a href="slash-piles.html#cb138-46" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(is_missing))</span>
<span id="cb138-47"><a href="slash-piles.html#cb138-47" tabindex="-1"></a>      </span>
<span id="cb138-48"><a href="slash-piles.html#cb138-48" tabindex="-1"></a>      <span class="co"># plt</span></span>
<span id="cb138-49"><a href="slash-piles.html#cb138-49" tabindex="-1"></a>      plt <span class="ot">&lt;-</span></span>
<span id="cb138-50"><a href="slash-piles.html#cb138-50" tabindex="-1"></a>        ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb138-51"><a href="slash-piles.html#cb138-51" tabindex="-1"></a>          <span class="co"># add rgb base map</span></span>
<span id="cb138-52"><a href="slash-piles.html#cb138-52" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>(<span class="at">data =</span> rgb_df_temp, <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">fill =</span> hex_col), <span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb138-53"><a href="slash-piles.html#cb138-53" tabindex="-1"></a>          <span class="co"># use identity scale so the hex codes are used directly</span></span>
<span id="cb138-54"><a href="slash-piles.html#cb138-54" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">scale_fill_identity</span>(<span class="at">na.value =</span> <span class="st">&quot;transparent&quot;</span>) <span class="sc">+</span> <span class="co"># !!! don&#39;t take this out or RGB plot will kill your computer</span></span>
<span id="cb138-55"><a href="slash-piles.html#cb138-55" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb138-56"><a href="slash-piles.html#cb138-56" tabindex="-1"></a>            <span class="at">data =</span> sp_temp</span>
<span id="cb138-57"><a href="slash-piles.html#cb138-57" tabindex="-1"></a>            , <span class="at">color =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">lwd =</span> <span class="fl">1.5</span></span>
<span id="cb138-58"><a href="slash-piles.html#cb138-58" tabindex="-1"></a>          ) <span class="sc">+</span></span>
<span id="cb138-59"><a href="slash-piles.html#cb138-59" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb138-60"><a href="slash-piles.html#cb138-60" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb138-61"><a href="slash-piles.html#cb138-61" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">coord_sf</span>(<span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb138-62"><a href="slash-piles.html#cb138-62" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb138-63"><a href="slash-piles.html#cb138-63" tabindex="-1"></a>          ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb138-64"><a href="slash-piles.html#cb138-64" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb138-65"><a href="slash-piles.html#cb138-65" tabindex="-1"></a>          )    </span>
<span id="cb138-66"><a href="slash-piles.html#cb138-66" tabindex="-1"></a>      <span class="fu">return</span>(plt)</span>
<span id="cb138-67"><a href="slash-piles.html#cb138-67" tabindex="-1"></a>  })</span>
<span id="cb138-68"><a href="slash-piles.html#cb138-68" tabindex="-1"></a><span class="co"># plts_temp[[1]]</span></span></code></pre></div>
<p>plot with <code>patchwork</code></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="slash-piles.html#cb139-1" tabindex="-1"></a>wplts_temp <span class="ot">&lt;-</span> patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(plts_temp, <span class="at">ncol =</span> <span class="dv">5</span>, <span class="at">nrow =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb139-2"><a href="slash-piles.html#cb139-2" tabindex="-1"></a>  patchwork<span class="sc">::</span><span class="fu">plot_annotation</span>(</span>
<span id="cb139-3"><a href="slash-piles.html#cb139-3" tabindex="-1"></a>    <span class="at">tag_levels =</span> <span class="fu">list</span>(</span>
<span id="cb139-4"><a href="slash-piles.html#cb139-4" tabindex="-1"></a>      <span class="co"># as.vector(rbind(paste(&quot;Spectral Thrshlds Met&quot;, 1:6), matrix(&quot;&quot;, nrow = 4, ncol = 6)))  </span></span>
<span id="cb139-5"><a href="slash-piles.html#cb139-5" tabindex="-1"></a>      <span class="fu">rep</span>(<span class="st">&quot;&quot;</span>, <span class="dv">30</span>) <span class="sc">%&gt;%</span> <span class="fu">replace</span>(<span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">5</span>), <span class="fu">paste</span>(<span class="st">&quot;Spectral Thrshlds Met&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))</span>
<span id="cb139-6"><a href="slash-piles.html#cb139-6" tabindex="-1"></a>    )</span>
<span id="cb139-7"><a href="slash-piles.html#cb139-7" tabindex="-1"></a>  ) <span class="sc">&amp;</span></span>
<span id="cb139-8"><a href="slash-piles.html#cb139-8" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb139-9"><a href="slash-piles.html#cb139-9" tabindex="-1"></a>    <span class="at">plot.tag.position =</span> <span class="st">&quot;top&quot;</span></span>
<span id="cb139-10"><a href="slash-piles.html#cb139-10" tabindex="-1"></a>    , <span class="at">plot.tag =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb139-11"><a href="slash-piles.html#cb139-11" tabindex="-1"></a>  )</span>
<span id="cb139-12"><a href="slash-piles.html#cb139-12" tabindex="-1"></a><span class="co"># huh?</span></span>
<span id="cb139-13"><a href="slash-piles.html#cb139-13" tabindex="-1"></a>wplts_temp</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-108-1.png" alt="" width="1008" /></p>
<p>based on this visual inspection, we’ll use all detected piles that meet at least 5 thresholds for our mask to remove detected “trees” that are likely not trees</p>
</div>
<div id="slash-pile-summary-statistics" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Slash Pile Summary Statistics<a href="slash-piles.html#slash-pile-summary-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>first we’ll plot the slash piles in a treatment unit overlaid on the CHM</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="slash-piles.html#cb140-1" tabindex="-1"></a>unt_temp <span class="ot">&lt;-</span> piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb140-2"><a href="slash-piles.html#cb140-2" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb140-3"><a href="slash-piles.html#cb140-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(is_in_trtmnt_unit) <span class="sc">%&gt;%</span> </span>
<span id="cb140-4"><a href="slash-piles.html#cb140-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">distinct</span>(trtmnt_type,trtmnt_block,trtmnt_unit) <span class="sc">%&gt;%</span> </span>
<span id="cb140-5"><a href="slash-piles.html#cb140-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(trtmnt_type,trtmnt_block,trtmnt_unit)</span>
<span id="cb140-6"><a href="slash-piles.html#cb140-6" tabindex="-1"></a>plts_temp <span class="ot">&lt;-</span> </span>
<span id="cb140-7"><a href="slash-piles.html#cb140-7" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(unt_temp) <span class="sc">%&gt;%</span> </span>
<span id="cb140-8"><a href="slash-piles.html#cb140-8" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="cf">function</span>(x){</span>
<span id="cb140-9"><a href="slash-piles.html#cb140-9" tabindex="-1"></a>    unit_temp <span class="ot">&lt;-</span> stand_boundary <span class="sc">%&gt;%</span> </span>
<span id="cb140-10"><a href="slash-piles.html#cb140-10" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb140-11"><a href="slash-piles.html#cb140-11" tabindex="-1"></a>        unit <span class="sc">==</span> unt_temp<span class="sc">$</span>trtmnt_unit[x]</span>
<span id="cb140-12"><a href="slash-piles.html#cb140-12" tabindex="-1"></a>        , block <span class="sc">==</span> unt_temp<span class="sc">$</span>trtmnt_block[x]</span>
<span id="cb140-13"><a href="slash-piles.html#cb140-13" tabindex="-1"></a>        , stringr<span class="sc">::</span><span class="fu">str_squish</span>(<span class="fu">tolower</span>(tretmnt)) <span class="sc">==</span> unt_temp<span class="sc">$</span>trtmnt_type[x]</span>
<span id="cb140-14"><a href="slash-piles.html#cb140-14" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb140-15"><a href="slash-piles.html#cb140-15" tabindex="-1"></a>      sf<span class="sc">::</span><span class="fu">st_transform</span>(terra<span class="sc">::</span><span class="fu">crs</span>(chm_rast))</span>
<span id="cb140-16"><a href="slash-piles.html#cb140-16" tabindex="-1"></a>    piles_temp <span class="ot">&lt;-</span> piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb140-17"><a href="slash-piles.html#cb140-17" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">inner_join</span>(</span>
<span id="cb140-18"><a href="slash-piles.html#cb140-18" tabindex="-1"></a>        unt_temp <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(x)</span>
<span id="cb140-19"><a href="slash-piles.html#cb140-19" tabindex="-1"></a>        , <span class="at">by =</span> dplyr<span class="sc">::</span><span class="fu">join_by</span>(trtmnt_type,trtmnt_block,trtmnt_unit)</span>
<span id="cb140-20"><a href="slash-piles.html#cb140-20" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb140-21"><a href="slash-piles.html#cb140-21" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb140-22"><a href="slash-piles.html#cb140-22" tabindex="-1"></a>        is_in_trtmnt_unit</span>
<span id="cb140-23"><a href="slash-piles.html#cb140-23" tabindex="-1"></a>        ,inrange_th_votes<span class="sc">&gt;=</span><span class="dv">5</span></span>
<span id="cb140-24"><a href="slash-piles.html#cb140-24" tabindex="-1"></a>      )</span>
<span id="cb140-25"><a href="slash-piles.html#cb140-25" tabindex="-1"></a>    chm_temp <span class="ot">&lt;-</span> chm_rast <span class="sc">%&gt;%</span> </span>
<span id="cb140-26"><a href="slash-piles.html#cb140-26" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">crop</span>(</span>
<span id="cb140-27"><a href="slash-piles.html#cb140-27" tabindex="-1"></a>        unit_temp <span class="sc">%&gt;%</span> sf<span class="sc">::</span><span class="fu">st_buffer</span>(<span class="dv">5</span>) <span class="sc">%&gt;%</span> terra<span class="sc">::</span><span class="fu">vect</span>()</span>
<span id="cb140-28"><a href="slash-piles.html#cb140-28" tabindex="-1"></a>        , <span class="at">mask =</span> T</span>
<span id="cb140-29"><a href="slash-piles.html#cb140-29" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb140-30"><a href="slash-piles.html#cb140-30" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">aggregate</span>(<span class="at">fact=</span><span class="dv">2</span>, <span class="at">fun =</span> <span class="st">&quot;max&quot;</span>, <span class="at">na.rm =</span> T) <span class="sc">%&gt;%</span> </span>
<span id="cb140-31"><a href="slash-piles.html#cb140-31" tabindex="-1"></a>      terra<span class="sc">::</span><span class="fu">as.data.frame</span>(<span class="at">xy=</span>T) <span class="sc">%&gt;%</span> </span>
<span id="cb140-32"><a href="slash-piles.html#cb140-32" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">f =</span> <span class="dv">3</span>)</span>
<span id="cb140-33"><a href="slash-piles.html#cb140-33" tabindex="-1"></a>    <span class="co"># plt</span></span>
<span id="cb140-34"><a href="slash-piles.html#cb140-34" tabindex="-1"></a>    ggplot2<span class="sc">::</span><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb140-35"><a href="slash-piles.html#cb140-35" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">geom_tile</span>(</span>
<span id="cb140-36"><a href="slash-piles.html#cb140-36" tabindex="-1"></a>        <span class="at">data =</span> chm_temp</span>
<span id="cb140-37"><a href="slash-piles.html#cb140-37" tabindex="-1"></a>        , <span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">fill=</span>f)</span>
<span id="cb140-38"><a href="slash-piles.html#cb140-38" tabindex="-1"></a>        , <span class="at">color =</span> <span class="cn">NA</span></span>
<span id="cb140-39"><a href="slash-piles.html#cb140-39" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb140-40"><a href="slash-piles.html#cb140-40" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">scale_fill_viridis_c</span>(</span>
<span id="cb140-41"><a href="slash-piles.html#cb140-41" tabindex="-1"></a>        <span class="at">option =</span> <span class="st">&quot;plasma&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span></span>
<span id="cb140-42"><a href="slash-piles.html#cb140-42" tabindex="-1"></a>        , <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">floor</span>(terra<span class="sc">::</span><span class="fu">minmax</span>(chm_rast)[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">1.02</span>))</span>
<span id="cb140-43"><a href="slash-piles.html#cb140-43" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb140-44"><a href="slash-piles.html#cb140-44" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(<span class="at">data =</span> unit_temp, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb140-45"><a href="slash-piles.html#cb140-45" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">geom_sf</span>(</span>
<span id="cb140-46"><a href="slash-piles.html#cb140-46" tabindex="-1"></a>        <span class="at">data =</span> piles_temp</span>
<span id="cb140-47"><a href="slash-piles.html#cb140-47" tabindex="-1"></a>        , <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;cyan&quot;</span>, <span class="at">lwd =</span> <span class="fl">0.3</span></span>
<span id="cb140-48"><a href="slash-piles.html#cb140-48" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb140-49"><a href="slash-piles.html#cb140-49" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb140-50"><a href="slash-piles.html#cb140-50" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="fu">paste0</span>(</span>
<span id="cb140-51"><a href="slash-piles.html#cb140-51" tabindex="-1"></a>          piles_temp<span class="sc">$</span>trtmnt_type[<span class="dv">1</span>]</span>
<span id="cb140-52"><a href="slash-piles.html#cb140-52" tabindex="-1"></a>          , <span class="st">&quot;</span><span class="sc">\n</span><span class="st">block: &quot;</span></span>
<span id="cb140-53"><a href="slash-piles.html#cb140-53" tabindex="-1"></a>          , piles_temp<span class="sc">$</span>trtmnt_block[<span class="dv">1</span>]</span>
<span id="cb140-54"><a href="slash-piles.html#cb140-54" tabindex="-1"></a>          , <span class="st">&quot; | &quot;</span></span>
<span id="cb140-55"><a href="slash-piles.html#cb140-55" tabindex="-1"></a>          , piles_temp<span class="sc">$</span>trtmnt_unit[<span class="dv">1</span>]</span>
<span id="cb140-56"><a href="slash-piles.html#cb140-56" tabindex="-1"></a>        )</span>
<span id="cb140-57"><a href="slash-piles.html#cb140-57" tabindex="-1"></a>        , <span class="at">fill =</span> <span class="st">&quot;CHM (m)&quot;</span></span>
<span id="cb140-58"><a href="slash-piles.html#cb140-58" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb140-59"><a href="slash-piles.html#cb140-59" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb140-60"><a href="slash-piles.html#cb140-60" tabindex="-1"></a>      ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb140-61"><a href="slash-piles.html#cb140-61" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb140-62"><a href="slash-piles.html#cb140-62" tabindex="-1"></a>        , <span class="at">legend.title =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>)</span>
<span id="cb140-63"><a href="slash-piles.html#cb140-63" tabindex="-1"></a>        , <span class="at">legend.text =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb140-64"><a href="slash-piles.html#cb140-64" tabindex="-1"></a>        , <span class="at">plot.subtitle =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>)</span>
<span id="cb140-65"><a href="slash-piles.html#cb140-65" tabindex="-1"></a>      )  </span>
<span id="cb140-66"><a href="slash-piles.html#cb140-66" tabindex="-1"></a>  })</span>
<span id="cb140-67"><a href="slash-piles.html#cb140-67" tabindex="-1"></a><span class="co"># length(plts_temp)</span></span>
<span id="cb140-68"><a href="slash-piles.html#cb140-68" tabindex="-1"></a><span class="co"># plts_temp[[1]]</span></span>
<span id="cb140-69"><a href="slash-piles.html#cb140-69" tabindex="-1"></a></span>
<span id="cb140-70"><a href="slash-piles.html#cb140-70" tabindex="-1"></a><span class="co"># chm_rast %&gt;% </span></span>
<span id="cb140-71"><a href="slash-piles.html#cb140-71" tabindex="-1"></a><span class="co">#   # terra::aggregate(fact = 2, fun=&quot;max&quot;,na.rm=T,cores=lasR::half_cores()) %&gt;% </span></span>
<span id="cb140-72"><a href="slash-piles.html#cb140-72" tabindex="-1"></a><span class="co">#   terra::plot(col = viridis::plasma(n=100), main = &quot;CHM (m)&quot;, axes = F)</span></span>
<span id="cb140-73"><a href="slash-piles.html#cb140-73" tabindex="-1"></a><span class="co"># terra::plot(</span></span>
<span id="cb140-74"><a href="slash-piles.html#cb140-74" tabindex="-1"></a><span class="co">#     stand_boundary %&gt;% terra::vect()</span></span>
<span id="cb140-75"><a href="slash-piles.html#cb140-75" tabindex="-1"></a><span class="co">#     , add = T, border = &quot;black&quot;, col = NA, lwd = 1.5</span></span>
<span id="cb140-76"><a href="slash-piles.html#cb140-76" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb140-77"><a href="slash-piles.html#cb140-77" tabindex="-1"></a><span class="co"># terra::plot(</span></span>
<span id="cb140-78"><a href="slash-piles.html#cb140-78" tabindex="-1"></a><span class="co">#     piles_workflow_ans %&gt;% </span></span>
<span id="cb140-79"><a href="slash-piles.html#cb140-79" tabindex="-1"></a><span class="co">#       dplyr::filter(is_in_trtmnt_unit) %&gt;% </span></span>
<span id="cb140-80"><a href="slash-piles.html#cb140-80" tabindex="-1"></a><span class="co">#       terra::vect()</span></span>
<span id="cb140-81"><a href="slash-piles.html#cb140-81" tabindex="-1"></a><span class="co">#     , add = T, border = &quot;cyan&quot;, col = NA, lwd = 1.5</span></span>
<span id="cb140-82"><a href="slash-piles.html#cb140-82" tabindex="-1"></a><span class="co">#   )</span></span></code></pre></div>
<p><strong>heterogenous</strong> units</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="slash-piles.html#cb141-1" tabindex="-1"></a>wplts_temp <span class="ot">&lt;-</span> patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(</span>
<span id="cb141-2"><a href="slash-piles.html#cb141-2" tabindex="-1"></a>  plts_temp[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb141-3"><a href="slash-piles.html#cb141-3" tabindex="-1"></a>  , <span class="at">ncol =</span> <span class="dv">4</span></span>
<span id="cb141-4"><a href="slash-piles.html#cb141-4" tabindex="-1"></a>  , <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span></span>
<span id="cb141-5"><a href="slash-piles.html#cb141-5" tabindex="-1"></a>) <span class="sc">&amp;</span></span>
<span id="cb141-6"><a href="slash-piles.html#cb141-6" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb141-7"><a href="slash-piles.html#cb141-7" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb141-8"><a href="slash-piles.html#cb141-8" tabindex="-1"></a>    <span class="co"># , legend.text = ggplot2::element_text(size = 7)</span></span>
<span id="cb141-9"><a href="slash-piles.html#cb141-9" tabindex="-1"></a>  )</span>
<span id="cb141-10"><a href="slash-piles.html#cb141-10" tabindex="-1"></a><span class="co"># huh?</span></span>
<span id="cb141-11"><a href="slash-piles.html#cb141-11" tabindex="-1"></a>wplts_temp</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-111-1.png" alt="" width="1008" /></p>
<p><strong>uniform - high</strong> units</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="slash-piles.html#cb142-1" tabindex="-1"></a>wplts_temp <span class="ot">&lt;-</span> patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(</span>
<span id="cb142-2"><a href="slash-piles.html#cb142-2" tabindex="-1"></a>  plts_temp[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>]</span>
<span id="cb142-3"><a href="slash-piles.html#cb142-3" tabindex="-1"></a>  , <span class="at">ncol =</span> <span class="dv">4</span></span>
<span id="cb142-4"><a href="slash-piles.html#cb142-4" tabindex="-1"></a>  , <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span></span>
<span id="cb142-5"><a href="slash-piles.html#cb142-5" tabindex="-1"></a>) <span class="sc">&amp;</span></span>
<span id="cb142-6"><a href="slash-piles.html#cb142-6" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb142-7"><a href="slash-piles.html#cb142-7" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb142-8"><a href="slash-piles.html#cb142-8" tabindex="-1"></a>    <span class="co"># , legend.text = ggplot2::element_text(size = 7)</span></span>
<span id="cb142-9"><a href="slash-piles.html#cb142-9" tabindex="-1"></a>  )</span>
<span id="cb142-10"><a href="slash-piles.html#cb142-10" tabindex="-1"></a><span class="co"># huh?</span></span>
<span id="cb142-11"><a href="slash-piles.html#cb142-11" tabindex="-1"></a>wplts_temp</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-112-1.png" alt="" width="1008" /></p>
<p><strong>uniform - low</strong> units</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="slash-piles.html#cb143-1" tabindex="-1"></a>wplts_temp <span class="ot">&lt;-</span> patchwork<span class="sc">::</span><span class="fu">wrap_plots</span>(</span>
<span id="cb143-2"><a href="slash-piles.html#cb143-2" tabindex="-1"></a>  plts_temp[<span class="dv">25</span><span class="sc">:</span><span class="dv">36</span>]</span>
<span id="cb143-3"><a href="slash-piles.html#cb143-3" tabindex="-1"></a>  , <span class="at">ncol =</span> <span class="dv">3</span></span>
<span id="cb143-4"><a href="slash-piles.html#cb143-4" tabindex="-1"></a>  , <span class="at">guides =</span> <span class="st">&quot;collect&quot;</span></span>
<span id="cb143-5"><a href="slash-piles.html#cb143-5" tabindex="-1"></a>) <span class="sc">&amp;</span></span>
<span id="cb143-6"><a href="slash-piles.html#cb143-6" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb143-7"><a href="slash-piles.html#cb143-7" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb143-8"><a href="slash-piles.html#cb143-8" tabindex="-1"></a>    <span class="co"># , legend.text = ggplot2::element_text(size = 7)</span></span>
<span id="cb143-9"><a href="slash-piles.html#cb143-9" tabindex="-1"></a>  )</span>
<span id="cb143-10"><a href="slash-piles.html#cb143-10" tabindex="-1"></a><span class="co"># huh?</span></span>
<span id="cb143-11"><a href="slash-piles.html#cb143-11" tabindex="-1"></a>wplts_temp</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-113-1.png" alt="" width="1008" /></p>
<p>let’s aggregate the detected slash pile information by treatment unit</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="slash-piles.html#cb144-1" tabindex="-1"></a><span class="co"># hey</span></span>
<span id="cb144-2"><a href="slash-piles.html#cb144-2" tabindex="-1"></a>pile_sum_temp <span class="ot">&lt;-</span> piles_workflow_ans <span class="sc">%&gt;%</span> </span>
<span id="cb144-3"><a href="slash-piles.html#cb144-3" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb144-4"><a href="slash-piles.html#cb144-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb144-5"><a href="slash-piles.html#cb144-5" tabindex="-1"></a>    is_in_trtmnt_unit</span>
<span id="cb144-6"><a href="slash-piles.html#cb144-6" tabindex="-1"></a>    , inrange_th_votes<span class="sc">&gt;=</span><span class="dv">5</span></span>
<span id="cb144-7"><a href="slash-piles.html#cb144-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb144-8"><a href="slash-piles.html#cb144-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb144-9"><a href="slash-piles.html#cb144-9" tabindex="-1"></a>    trtmnt_type,trtmnt_block,trtmnt_unit, trtmnt_unit_area_ha</span>
<span id="cb144-10"><a href="slash-piles.html#cb144-10" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb144-11"><a href="slash-piles.html#cb144-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(</span>
<span id="cb144-12"><a href="slash-piles.html#cb144-12" tabindex="-1"></a>    <span class="at">n_piles =</span> dplyr<span class="sc">::</span><span class="fu">n</span>()</span>
<span id="cb144-13"><a href="slash-piles.html#cb144-13" tabindex="-1"></a>    , dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb144-14"><a href="slash-piles.html#cb144-14" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(area_m2, volume_m3)</span>
<span id="cb144-15"><a href="slash-piles.html#cb144-15" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="fu">list</span>(<span class="at">mean =</span> <span class="sc">~</span><span class="fu">mean</span>(.x,<span class="at">na.rm=</span>T), <span class="at">sum =</span> <span class="sc">~</span><span class="fu">sum</span>(.x,<span class="at">na.rm=</span>T))</span>
<span id="cb144-16"><a href="slash-piles.html#cb144-16" tabindex="-1"></a>    )</span>
<span id="cb144-17"><a href="slash-piles.html#cb144-17" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb144-18"><a href="slash-piles.html#cb144-18" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb144-19"><a href="slash-piles.html#cb144-19" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">piles_per_ha =</span> n_piles<span class="sc">/</span>trtmnt_unit_area_ha) <span class="sc">%&gt;%</span> </span>
<span id="cb144-20"><a href="slash-piles.html#cb144-20" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(trtmnt_type,trtmnt_block,trtmnt_unit )</span></code></pre></div>
<p>table it by treatment unit</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="slash-piles.html#cb145-1" tabindex="-1"></a>pile_sum_temp <span class="sc">%&gt;%</span> </span>
<span id="cb145-2"><a href="slash-piles.html#cb145-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb145-3"><a href="slash-piles.html#cb145-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb145-4"><a href="slash-piles.html#cb145-4" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(n_piles, tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_sum&quot;</span>))</span>
<span id="cb145-5"><a href="slash-piles.html#cb145-5" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">comma</span>(.x,<span class="at">accuracy=</span><span class="dv">1</span>)</span>
<span id="cb145-6"><a href="slash-piles.html#cb145-6" tabindex="-1"></a>    )</span>
<span id="cb145-7"><a href="slash-piles.html#cb145-7" tabindex="-1"></a>    , dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb145-8"><a href="slash-piles.html#cb145-8" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(trtmnt_unit_area_ha, piles_per_ha, tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_mean&quot;</span>))</span>
<span id="cb145-9"><a href="slash-piles.html#cb145-9" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">comma</span>(.x,<span class="at">accuracy=</span><span class="fl">0.1</span>)</span>
<span id="cb145-10"><a href="slash-piles.html#cb145-10" tabindex="-1"></a>    )</span>
<span id="cb145-11"><a href="slash-piles.html#cb145-11" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb145-12"><a href="slash-piles.html#cb145-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">relocate</span>(</span>
<span id="cb145-13"><a href="slash-piles.html#cb145-13" tabindex="-1"></a>    trtmnt_type,trtmnt_block,trtmnt_unit, trtmnt_unit_area_ha</span>
<span id="cb145-14"><a href="slash-piles.html#cb145-14" tabindex="-1"></a>    , n_piles, piles_per_ha</span>
<span id="cb145-15"><a href="slash-piles.html#cb145-15" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb145-16"><a href="slash-piles.html#cb145-16" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb145-17"><a href="slash-piles.html#cb145-17" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;slash pile quantity by treatment unit&quot;</span></span>
<span id="cb145-18"><a href="slash-piles.html#cb145-18" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb145-19"><a href="slash-piles.html#cb145-19" tabindex="-1"></a>      <span class="st">&quot;type&quot;</span>,<span class="st">&quot;block&quot;</span>,<span class="st">&quot;unit&quot;</span>,<span class="st">&quot;ha&quot;</span></span>
<span id="cb145-20"><a href="slash-piles.html#cb145-20" tabindex="-1"></a>      , <span class="st">&quot;# piles&quot;</span>, <span class="st">&quot;piles ha&lt;sup&gt;-1&lt;/sup&gt;&quot;</span></span>
<span id="cb145-21"><a href="slash-piles.html#cb145-21" tabindex="-1"></a>      , <span class="st">&quot;mean pile&lt;br&gt;area (m&lt;sup&gt;2&lt;/sup&gt;)&quot;</span></span>
<span id="cb145-22"><a href="slash-piles.html#cb145-22" tabindex="-1"></a>      , <span class="st">&quot;tot. pile&lt;br&gt;area (m&lt;sup&gt;2&lt;/sup&gt;)&quot;</span></span>
<span id="cb145-23"><a href="slash-piles.html#cb145-23" tabindex="-1"></a>      , <span class="st">&quot;mean pile&lt;br&gt;bulk vol. (m&lt;sup&gt;3&lt;/sup&gt;)&quot;</span></span>
<span id="cb145-24"><a href="slash-piles.html#cb145-24" tabindex="-1"></a>      , <span class="st">&quot;tot. pile&lt;br&gt;bulk vol. (m&lt;sup&gt;3&lt;/sup&gt;)&quot;</span></span>
<span id="cb145-25"><a href="slash-piles.html#cb145-25" tabindex="-1"></a>    )</span>
<span id="cb145-26"><a href="slash-piles.html#cb145-26" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb145-27"><a href="slash-piles.html#cb145-27" tabindex="-1"></a>    <span class="co"># , digits = 2</span></span>
<span id="cb145-28"><a href="slash-piles.html#cb145-28" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb145-29"><a href="slash-piles.html#cb145-29" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="fl">9.7</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb145-30"><a href="slash-piles.html#cb145-30" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(<span class="fu">seq</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="at">by=</span><span class="dv">2</span>), <span class="at">border_right =</span> <span class="cn">TRUE</span>, <span class="at">include_thead =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb145-31"><a href="slash-piles.html#cb145-31" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb145-32"><a href="slash-piles.html#cb145-32" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">scroll_box</span>(<span class="at">height =</span> <span class="st">&quot;8.4in&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:8.4in; ">
<table class="table" style="font-size: 9.7px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-116">Table 3.1: </span>slash pile quantity by treatment unit
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
type
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
block
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
unit
</th>
<th style="text-align:left;border-right:1px solid;position: sticky; top:0; background-color: #FFFFFF;">
ha
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
# piles
</th>
<th style="text-align:left;border-right:1px solid;position: sticky; top:0; background-color: #FFFFFF;">
piles ha<sup>-1</sup>
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
mean pile<br>area (m<sup>2</sup>)
</th>
<th style="text-align:left;border-right:1px solid;position: sticky; top:0; background-color: #FFFFFF;">
tot. pile<br>area (m<sup>2</sup>)
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
mean pile<br>bulk vol. (m<sup>3</sup>)
</th>
<th style="text-align:left;border-right:1px solid;position: sticky; top:0; background-color: #FFFFFF;">
tot. pile<br>bulk vol. (m<sup>3</sup>)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="12">
heterogenous
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
U40
</td>
<td style="text-align:left;border-right:1px solid;">
9.1
</td>
<td style="text-align:left;">
464
</td>
<td style="text-align:left;border-right:1px solid;">
50.9
</td>
<td style="text-align:left;">
7.1
</td>
<td style="text-align:left;border-right:1px solid;">
3,306
</td>
<td style="text-align:left;">
5.8
</td>
<td style="text-align:left;border-right:1px solid;">
2,676
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
U16
</td>
<td style="text-align:left;border-right:1px solid;">
9.5
</td>
<td style="text-align:left;">
262
</td>
<td style="text-align:left;border-right:1px solid;">
27.6
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:left;border-right:1px solid;">
1,719
</td>
<td style="text-align:left;">
6.6
</td>
<td style="text-align:left;border-right:1px solid;">
1,717
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
U26
</td>
<td style="text-align:left;border-right:1px solid;">
9.0
</td>
<td style="text-align:left;">
382
</td>
<td style="text-align:left;border-right:1px solid;">
42.6
</td>
<td style="text-align:left;">
7.2
</td>
<td style="text-align:left;border-right:1px solid;">
2,733
</td>
<td style="text-align:left;">
6.7
</td>
<td style="text-align:left;border-right:1px solid;">
2,570
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
U36
</td>
<td style="text-align:left;border-right:1px solid;">
8.5
</td>
<td style="text-align:left;">
322
</td>
<td style="text-align:left;border-right:1px solid;">
37.9
</td>
<td style="text-align:left;">
7.1
</td>
<td style="text-align:left;border-right:1px solid;">
2,290
</td>
<td style="text-align:left;">
8.7
</td>
<td style="text-align:left;border-right:1px solid;">
2,804
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
U39
</td>
<td style="text-align:left;border-right:1px solid;">
8.3
</td>
<td style="text-align:left;">
442
</td>
<td style="text-align:left;border-right:1px solid;">
53.2
</td>
<td style="text-align:left;">
7.7
</td>
<td style="text-align:left;border-right:1px solid;">
3,385
</td>
<td style="text-align:left;">
7.0
</td>
<td style="text-align:left;border-right:1px solid;">
3,108
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
U29
</td>
<td style="text-align:left;border-right:1px solid;">
9.2
</td>
<td style="text-align:left;">
520
</td>
<td style="text-align:left;border-right:1px solid;">
56.7
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;border-right:1px solid;">
3,973
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
3,267
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
U44
</td>
<td style="text-align:left;border-right:1px solid;">
8.6
</td>
<td style="text-align:left;">
181
</td>
<td style="text-align:left;border-right:1px solid;">
21.0
</td>
<td style="text-align:left;">
5.3
</td>
<td style="text-align:left;border-right:1px solid;">
967
</td>
<td style="text-align:left;">
8.5
</td>
<td style="text-align:left;border-right:1px solid;">
1,535
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
U2
</td>
<td style="text-align:left;border-right:1px solid;">
8.3
</td>
<td style="text-align:left;">
308
</td>
<td style="text-align:left;border-right:1px solid;">
37.2
</td>
<td style="text-align:left;">
6.7
</td>
<td style="text-align:left;border-right:1px solid;">
2,062
</td>
<td style="text-align:left;">
8.3
</td>
<td style="text-align:left;border-right:1px solid;">
2,555
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
U53
</td>
<td style="text-align:left;border-right:1px solid;">
8.4
</td>
<td style="text-align:left;">
325
</td>
<td style="text-align:left;border-right:1px solid;">
38.5
</td>
<td style="text-align:left;">
6.9
</td>
<td style="text-align:left;border-right:1px solid;">
2,240
</td>
<td style="text-align:left;">
4.6
</td>
<td style="text-align:left;border-right:1px solid;">
1,492
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
U41
</td>
<td style="text-align:left;border-right:1px solid;">
8.2
</td>
<td style="text-align:left;">
423
</td>
<td style="text-align:left;border-right:1px solid;">
51.6
</td>
<td style="text-align:left;">
7.2
</td>
<td style="text-align:left;border-right:1px solid;">
3,038
</td>
<td style="text-align:left;">
5.5
</td>
<td style="text-align:left;border-right:1px solid;">
2,323
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
U43
</td>
<td style="text-align:left;border-right:1px solid;">
8.1
</td>
<td style="text-align:left;">
434
</td>
<td style="text-align:left;border-right:1px solid;">
53.4
</td>
<td style="text-align:left;">
7.3
</td>
<td style="text-align:left;border-right:1px solid;">
3,174
</td>
<td style="text-align:left;">
5.5
</td>
<td style="text-align:left;border-right:1px solid;">
2,383
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
U55
</td>
<td style="text-align:left;border-right:1px solid;">
9.2
</td>
<td style="text-align:left;">
372
</td>
<td style="text-align:left;border-right:1px solid;">
40.4
</td>
<td style="text-align:left;">
7.2
</td>
<td style="text-align:left;border-right:1px solid;">
2,666
</td>
<td style="text-align:left;">
5.3
</td>
<td style="text-align:left;border-right:1px solid;">
1,955
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="12">
uniform- high
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
U10
</td>
<td style="text-align:left;border-right:1px solid;">
5.2
</td>
<td style="text-align:left;">
320
</td>
<td style="text-align:left;border-right:1px solid;">
61.8
</td>
<td style="text-align:left;">
8.9
</td>
<td style="text-align:left;border-right:1px solid;">
2,861
</td>
<td style="text-align:left;">
5.5
</td>
<td style="text-align:left;border-right:1px solid;">
1,754
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
U19
</td>
<td style="text-align:left;border-right:1px solid;">
4.5
</td>
<td style="text-align:left;">
74
</td>
<td style="text-align:left;border-right:1px solid;">
16.5
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;border-right:1px solid;">
564
</td>
<td style="text-align:left;">
6.9
</td>
<td style="text-align:left;border-right:1px solid;">
513
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
U18
</td>
<td style="text-align:left;border-right:1px solid;">
4.1
</td>
<td style="text-align:left;">
112
</td>
<td style="text-align:left;border-right:1px solid;">
27.3
</td>
<td style="text-align:left;">
6.9
</td>
<td style="text-align:left;border-right:1px solid;">
778
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
707
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
U27
</td>
<td style="text-align:left;border-right:1px solid;">
4.2
</td>
<td style="text-align:left;">
128
</td>
<td style="text-align:left;border-right:1px solid;">
30.7
</td>
<td style="text-align:left;">
7.7
</td>
<td style="text-align:left;border-right:1px solid;">
980
</td>
<td style="text-align:left;">
5.9
</td>
<td style="text-align:left;border-right:1px solid;">
761
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
U37
</td>
<td style="text-align:left;border-right:1px solid;">
5.6
</td>
<td style="text-align:left;">
128
</td>
<td style="text-align:left;border-right:1px solid;">
22.8
</td>
<td style="text-align:left;">
6.7
</td>
<td style="text-align:left;border-right:1px solid;">
859
</td>
<td style="text-align:left;">
8.1
</td>
<td style="text-align:left;border-right:1px solid;">
1,043
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
U28
</td>
<td style="text-align:left;border-right:1px solid;">
4.3
</td>
<td style="text-align:left;">
100
</td>
<td style="text-align:left;border-right:1px solid;">
23.3
</td>
<td style="text-align:left;">
8.4
</td>
<td style="text-align:left;border-right:1px solid;">
845
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
635
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
U45
</td>
<td style="text-align:left;border-right:1px solid;">
4.3
</td>
<td style="text-align:left;">
46
</td>
<td style="text-align:left;border-right:1px solid;">
10.7
</td>
<td style="text-align:left;">
4.7
</td>
<td style="text-align:left;border-right:1px solid;">
215
</td>
<td style="text-align:left;">
6.2
</td>
<td style="text-align:left;border-right:1px solid;">
284
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
U33
</td>
<td style="text-align:left;border-right:1px solid;">
4.5
</td>
<td style="text-align:left;">
166
</td>
<td style="text-align:left;border-right:1px solid;">
37.0
</td>
<td style="text-align:left;">
8.5
</td>
<td style="text-align:left;border-right:1px solid;">
1,412
</td>
<td style="text-align:left;">
5.6
</td>
<td style="text-align:left;border-right:1px solid;">
926
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
U52
</td>
<td style="text-align:left;border-right:1px solid;">
4.1
</td>
<td style="text-align:left;">
208
</td>
<td style="text-align:left;border-right:1px solid;">
50.7
</td>
<td style="text-align:left;">
9.2
</td>
<td style="text-align:left;border-right:1px solid;">
1,913
</td>
<td style="text-align:left;">
6.0
</td>
<td style="text-align:left;border-right:1px solid;">
1,254
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
U35
</td>
<td style="text-align:left;border-right:1px solid;">
4.4
</td>
<td style="text-align:left;">
287
</td>
<td style="text-align:left;border-right:1px solid;">
64.7
</td>
<td style="text-align:left;">
10.7
</td>
<td style="text-align:left;border-right:1px solid;">
3,077
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;border-right:1px solid;">
2,174
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
U49
</td>
<td style="text-align:left;border-right:1px solid;">
4.4
</td>
<td style="text-align:left;">
220
</td>
<td style="text-align:left;border-right:1px solid;">
50.1
</td>
<td style="text-align:left;">
8.7
</td>
<td style="text-align:left;border-right:1px solid;">
1,919
</td>
<td style="text-align:left;">
5.8
</td>
<td style="text-align:left;border-right:1px solid;">
1,278
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
U32
</td>
<td style="text-align:left;border-right:1px solid;">
5.1
</td>
<td style="text-align:left;">
180
</td>
<td style="text-align:left;border-right:1px solid;">
35.6
</td>
<td style="text-align:left;">
8.1
</td>
<td style="text-align:left;border-right:1px solid;">
1,467
</td>
<td style="text-align:left;">
6.2
</td>
<td style="text-align:left;border-right:1px solid;">
1,108
</td>
</tr>
<tr>
<td style="text-align:left;vertical-align: top !important;" rowspan="12">
uniform- low
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
U10
</td>
<td style="text-align:left;border-right:1px solid;">
5.2
</td>
<td style="text-align:left;">
317
</td>
<td style="text-align:left;border-right:1px solid;">
61.3
</td>
<td style="text-align:left;">
8.9
</td>
<td style="text-align:left;border-right:1px solid;">
2,827
</td>
<td style="text-align:left;">
5.5
</td>
<td style="text-align:left;border-right:1px solid;">
1,737
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
U19
</td>
<td style="text-align:left;border-right:1px solid;">
4.5
</td>
<td style="text-align:left;">
133
</td>
<td style="text-align:left;border-right:1px solid;">
29.6
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
834
</td>
<td style="text-align:left;">
6.7
</td>
<td style="text-align:left;border-right:1px solid;">
897
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
U18
</td>
<td style="text-align:left;border-right:1px solid;">
4.1
</td>
<td style="text-align:left;">
111
</td>
<td style="text-align:left;border-right:1px solid;">
27.0
</td>
<td style="text-align:left;">
5.8
</td>
<td style="text-align:left;border-right:1px solid;">
645
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;border-right:1px solid;">
843
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
U27
</td>
<td style="text-align:left;border-right:1px solid;">
4.2
</td>
<td style="text-align:left;">
196
</td>
<td style="text-align:left;border-right:1px solid;">
47.1
</td>
<td style="text-align:left;">
7.6
</td>
<td style="text-align:left;border-right:1px solid;">
1,485
</td>
<td style="text-align:left;">
5.4
</td>
<td style="text-align:left;border-right:1px solid;">
1,057
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
U37
</td>
<td style="text-align:left;border-right:1px solid;">
5.6
</td>
<td style="text-align:left;">
244
</td>
<td style="text-align:left;border-right:1px solid;">
43.4
</td>
<td style="text-align:left;">
8.1
</td>
<td style="text-align:left;border-right:1px solid;">
1,988
</td>
<td style="text-align:left;">
7.4
</td>
<td style="text-align:left;border-right:1px solid;">
1,795
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
U28
</td>
<td style="text-align:left;border-right:1px solid;">
4.3
</td>
<td style="text-align:left;">
211
</td>
<td style="text-align:left;border-right:1px solid;">
49.2
</td>
<td style="text-align:left;">
6.7
</td>
<td style="text-align:left;border-right:1px solid;">
1,407
</td>
<td style="text-align:left;">
5.1
</td>
<td style="text-align:left;border-right:1px solid;">
1,072
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
U45
</td>
<td style="text-align:left;border-right:1px solid;">
4.3
</td>
<td style="text-align:left;">
63
</td>
<td style="text-align:left;border-right:1px solid;">
14.7
</td>
<td style="text-align:left;">
6.1
</td>
<td style="text-align:left;border-right:1px solid;">
384
</td>
<td style="text-align:left;">
9.0
</td>
<td style="text-align:left;border-right:1px solid;">
566
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
U33
</td>
<td style="text-align:left;border-right:1px solid;">
4.5
</td>
<td style="text-align:left;">
229
</td>
<td style="text-align:left;border-right:1px solid;">
51.1
</td>
<td style="text-align:left;">
7.1
</td>
<td style="text-align:left;border-right:1px solid;">
1,634
</td>
<td style="text-align:left;">
5.8
</td>
<td style="text-align:left;border-right:1px solid;">
1,321
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
U52
</td>
<td style="text-align:left;border-right:1px solid;">
4.1
</td>
<td style="text-align:left;">
193
</td>
<td style="text-align:left;border-right:1px solid;">
47.1
</td>
<td style="text-align:left;">
7.9
</td>
<td style="text-align:left;border-right:1px solid;">
1,525
</td>
<td style="text-align:left;">
5.1
</td>
<td style="text-align:left;border-right:1px solid;">
978
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
U35
</td>
<td style="text-align:left;border-right:1px solid;">
4.4
</td>
<td style="text-align:left;">
279
</td>
<td style="text-align:left;border-right:1px solid;">
62.9
</td>
<td style="text-align:left;">
7.0
</td>
<td style="text-align:left;border-right:1px solid;">
1,944
</td>
<td style="text-align:left;">
5.6
</td>
<td style="text-align:left;border-right:1px solid;">
1,566
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
U49
</td>
<td style="text-align:left;border-right:1px solid;">
4.4
</td>
<td style="text-align:left;">
209
</td>
<td style="text-align:left;border-right:1px solid;">
47.6
</td>
<td style="text-align:left;">
8.3
</td>
<td style="text-align:left;border-right:1px solid;">
1,731
</td>
<td style="text-align:left;">
5.2
</td>
<td style="text-align:left;border-right:1px solid;">
1,097
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
U32
</td>
<td style="text-align:left;border-right:1px solid;">
5.1
</td>
<td style="text-align:left;">
370
</td>
<td style="text-align:left;border-right:1px solid;">
73.2
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
2,316
</td>
<td style="text-align:left;">
6.0
</td>
<td style="text-align:left;border-right:1px solid;">
2,229
</td>
</tr>
</tbody>
</table>
</div>
<p>plot piles per ha by treatment unit</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="slash-piles.html#cb146-1" tabindex="-1"></a>pile_sum_temp <span class="sc">%&gt;%</span> </span>
<span id="cb146-2"><a href="slash-piles.html#cb146-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="slash-piles.html#cb146-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb146-4"><a href="slash-piles.html#cb146-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(<span class="fu">c</span>(trtmnt_type,trtmnt_block,trtmnt_unit),as.ordered)</span>
<span id="cb146-5"><a href="slash-piles.html#cb146-5" tabindex="-1"></a>    , <span class="at">my_fct =</span> forcats<span class="sc">::</span><span class="fu">fct_cross</span>(trtmnt_type,trtmnt_block,trtmnt_unit)</span>
<span id="cb146-6"><a href="slash-piles.html#cb146-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb146-7"><a href="slash-piles.html#cb146-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(<span class="fu">desc</span>(trtmnt_type),piles_per_ha) <span class="sc">%&gt;%</span> </span>
<span id="cb146-8"><a href="slash-piles.html#cb146-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">my_fct =</span> forcats<span class="sc">::</span><span class="fu">fct_inorder</span>(my_fct)) <span class="sc">%&gt;%</span> </span>
<span id="cb146-9"><a href="slash-piles.html#cb146-9" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">mapping =</span> ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">x=</span>piles_per_ha,<span class="at">y=</span>my_fct,<span class="at">fill=</span>trtmnt_type,<span class="at">group =</span> trtmnt_type)) <span class="sc">+</span></span>
<span id="cb146-10"><a href="slash-piles.html#cb146-10" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_col</span>(<span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb146-11"><a href="slash-piles.html#cb146-11" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="at">n=</span><span class="dv">4</span>,<span class="at">name=</span><span class="st">&quot;Dark2&quot;</span>)[<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]) <span class="sc">+</span></span>
<span id="cb146-12"><a href="slash-piles.html#cb146-12" tabindex="-1"></a>  <span class="co"># ggplot2::scale_fill_brewer(palette = &quot;Dark2&quot;) +</span></span>
<span id="cb146-13"><a href="slash-piles.html#cb146-13" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb146-14"><a href="slash-piles.html#cb146-14" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb146-15"><a href="slash-piles.html#cb146-15" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;piles per ha&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb146-16"><a href="slash-piles.html#cb146-16" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">theme</span>(</span>
<span id="cb146-17"><a href="slash-piles.html#cb146-17" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span></span>
<span id="cb146-18"><a href="slash-piles.html#cb146-18" tabindex="-1"></a>    , <span class="at">axis.text.y =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">7</span>)</span>
<span id="cb146-19"><a href="slash-piles.html#cb146-19" tabindex="-1"></a>    , <span class="at">axis.text.x =</span> ggplot2<span class="sc">::</span><span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb146-20"><a href="slash-piles.html#cb146-20" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="blm_trfo_uas_files/figure-html/unnamed-chunk-117-1.png" alt="" width="1008" /></p>
<p>table it by treatment type</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="slash-piles.html#cb147-1" tabindex="-1"></a>pile_sum_temp <span class="sc">%&gt;%</span> </span>
<span id="cb147-2"><a href="slash-piles.html#cb147-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(trtmnt_type) <span class="sc">%&gt;%</span> </span>
<span id="cb147-3"><a href="slash-piles.html#cb147-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb147-4"><a href="slash-piles.html#cb147-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb147-5"><a href="slash-piles.html#cb147-5" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(trtmnt_unit_area_ha, n_piles, tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_sum&quot;</span>))</span>
<span id="cb147-6"><a href="slash-piles.html#cb147-6" tabindex="-1"></a>      , <span class="sc">~</span><span class="fu">sum</span>(.,<span class="at">na.rm =</span> T)</span>
<span id="cb147-7"><a href="slash-piles.html#cb147-7" tabindex="-1"></a>    )</span>
<span id="cb147-8"><a href="slash-piles.html#cb147-8" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb147-9"><a href="slash-piles.html#cb147-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb147-10"><a href="slash-piles.html#cb147-10" tabindex="-1"></a>    <span class="at">area_m2_mean =</span> area_m2_sum<span class="sc">/</span>n_piles</span>
<span id="cb147-11"><a href="slash-piles.html#cb147-11" tabindex="-1"></a>    , <span class="at">volume_m3_mean =</span> volume_m3_sum<span class="sc">/</span>n_piles</span>
<span id="cb147-12"><a href="slash-piles.html#cb147-12" tabindex="-1"></a>    , <span class="at">piles_per_ha =</span> n_piles<span class="sc">/</span>trtmnt_unit_area_ha</span>
<span id="cb147-13"><a href="slash-piles.html#cb147-13" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb147-14"><a href="slash-piles.html#cb147-14" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb147-15"><a href="slash-piles.html#cb147-15" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb147-16"><a href="slash-piles.html#cb147-16" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(n_piles, tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_sum&quot;</span>))</span>
<span id="cb147-17"><a href="slash-piles.html#cb147-17" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">comma</span>(.x,<span class="at">accuracy=</span><span class="dv">1</span>)</span>
<span id="cb147-18"><a href="slash-piles.html#cb147-18" tabindex="-1"></a>    )</span>
<span id="cb147-19"><a href="slash-piles.html#cb147-19" tabindex="-1"></a>    , dplyr<span class="sc">::</span><span class="fu">across</span>(</span>
<span id="cb147-20"><a href="slash-piles.html#cb147-20" tabindex="-1"></a>      <span class="at">.cols =</span> <span class="fu">c</span>(trtmnt_unit_area_ha, piles_per_ha, tidyselect<span class="sc">::</span><span class="fu">ends_with</span>(<span class="st">&quot;_mean&quot;</span>))</span>
<span id="cb147-21"><a href="slash-piles.html#cb147-21" tabindex="-1"></a>      , <span class="at">.fns =</span> <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">comma</span>(.x,<span class="at">accuracy=</span><span class="fl">0.1</span>)</span>
<span id="cb147-22"><a href="slash-piles.html#cb147-22" tabindex="-1"></a>    )</span>
<span id="cb147-23"><a href="slash-piles.html#cb147-23" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb147-24"><a href="slash-piles.html#cb147-24" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb147-25"><a href="slash-piles.html#cb147-25" tabindex="-1"></a>   trtmnt_type,trtmnt_unit_area_ha,n_piles</span>
<span id="cb147-26"><a href="slash-piles.html#cb147-26" tabindex="-1"></a>   , piles_per_ha</span>
<span id="cb147-27"><a href="slash-piles.html#cb147-27" tabindex="-1"></a>   , area_m2_mean,area_m2_sum</span>
<span id="cb147-28"><a href="slash-piles.html#cb147-28" tabindex="-1"></a>   , volume_m3_mean,volume_m3_sum</span>
<span id="cb147-29"><a href="slash-piles.html#cb147-29" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb147-30"><a href="slash-piles.html#cb147-30" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(</span>
<span id="cb147-31"><a href="slash-piles.html#cb147-31" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;slash pile quantity by treatment type&quot;</span></span>
<span id="cb147-32"><a href="slash-piles.html#cb147-32" tabindex="-1"></a>    , <span class="at">col.names =</span> <span class="fu">c</span>(</span>
<span id="cb147-33"><a href="slash-piles.html#cb147-33" tabindex="-1"></a>      <span class="st">&quot;type&quot;</span>,<span class="st">&quot;ha&quot;</span></span>
<span id="cb147-34"><a href="slash-piles.html#cb147-34" tabindex="-1"></a>      , <span class="st">&quot;# piles&quot;</span>, <span class="st">&quot;piles ha&lt;sup&gt;-1&lt;/sup&gt;&quot;</span></span>
<span id="cb147-35"><a href="slash-piles.html#cb147-35" tabindex="-1"></a>      , <span class="st">&quot;mean pile&lt;br&gt;area (m&lt;sup&gt;2&lt;/sup&gt;)&quot;</span></span>
<span id="cb147-36"><a href="slash-piles.html#cb147-36" tabindex="-1"></a>      , <span class="st">&quot;tot. pile&lt;br&gt;area (m&lt;sup&gt;2&lt;/sup&gt;)&quot;</span></span>
<span id="cb147-37"><a href="slash-piles.html#cb147-37" tabindex="-1"></a>      , <span class="st">&quot;mean pile&lt;br&gt;bulk vol. (m&lt;sup&gt;3&lt;/sup&gt;)&quot;</span></span>
<span id="cb147-38"><a href="slash-piles.html#cb147-38" tabindex="-1"></a>      , <span class="st">&quot;tot. pile&lt;br&gt;bulk vol. (m&lt;sup&gt;3&lt;/sup&gt;)&quot;</span></span>
<span id="cb147-39"><a href="slash-piles.html#cb147-39" tabindex="-1"></a>    )</span>
<span id="cb147-40"><a href="slash-piles.html#cb147-40" tabindex="-1"></a>    , <span class="at">escape =</span> F</span>
<span id="cb147-41"><a href="slash-piles.html#cb147-41" tabindex="-1"></a>    <span class="co"># , digits = 2</span></span>
<span id="cb147-42"><a href="slash-piles.html#cb147-42" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb147-43"><a href="slash-piles.html#cb147-43" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="fl">10.1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-44"><a href="slash-piles.html#cb147-44" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(<span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="at">by=</span><span class="dv">2</span>), <span class="at">border_right =</span> <span class="cn">TRUE</span>, <span class="at">include_thead =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb147-45"><a href="slash-piles.html#cb147-45" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="dv">1</span>, <span class="at">valign =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<table class="table" style="font-size: 10.1px; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
<span id="tab:unnamed-chunk-118">Table 3.2: </span>slash pile quantity by treatment type
</caption>
<thead>
<tr>
<th style="text-align:left;">
type
</th>
<th style="text-align:left;border-right:1px solid;">
ha
</th>
<th style="text-align:left;">
# piles
</th>
<th style="text-align:left;border-right:1px solid;">
piles ha<sup>-1</sup>
</th>
<th style="text-align:left;">
mean pile<br>area (m<sup>2</sup>)
</th>
<th style="text-align:left;border-right:1px solid;">
tot. pile<br>area (m<sup>2</sup>)
</th>
<th style="text-align:left;">
mean pile<br>bulk vol. (m<sup>3</sup>)
</th>
<th style="text-align:left;border-right:1px solid;">
tot. pile<br>bulk vol. (m<sup>3</sup>)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
heterogenous
</td>
<td style="text-align:left;border-right:1px solid;">
104.5
</td>
<td style="text-align:left;">
4,435
</td>
<td style="text-align:left;border-right:1px solid;">
42.5
</td>
<td style="text-align:left;">
7.1
</td>
<td style="text-align:left;border-right:1px solid;">
31,552
</td>
<td style="text-align:left;">
6.4
</td>
<td style="text-align:left;border-right:1px solid;">
28,384
</td>
</tr>
<tr>
<td style="text-align:left;">
uniform- high
</td>
<td style="text-align:left;border-right:1px solid;">
54.6
</td>
<td style="text-align:left;">
1,969
</td>
<td style="text-align:left;border-right:1px solid;">
36.1
</td>
<td style="text-align:left;">
8.6
</td>
<td style="text-align:left;border-right:1px solid;">
16,891
</td>
<td style="text-align:left;">
6.3
</td>
<td style="text-align:left;border-right:1px solid;">
12,436
</td>
</tr>
<tr>
<td style="text-align:left;">
uniform- low
</td>
<td style="text-align:left;border-right:1px solid;">
54.6
</td>
<td style="text-align:left;">
2,555
</td>
<td style="text-align:left;border-right:1px solid;">
46.8
</td>
<td style="text-align:left;">
7.3
</td>
<td style="text-align:left;border-right:1px solid;">
18,719
</td>
<td style="text-align:left;">
5.9
</td>
<td style="text-align:left;border-right:1px solid;">
15,158
</td>
</tr>
</tbody>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="processing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="treatment-unit-silvicultural-summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
